<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Introduction to Docker: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo.svg"><span class="badge text-bg-info">
          <abbr title="This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#polishing-beta-stage" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-circle" style="border-radius: 5px"></i>
              Beta
            </a>
            <span class="visually-hidden">This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Introduction to Docker
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Introduction to Docker
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"></ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Introduction to Docker
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="introduction.html">1. Introducing Containers</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="docker-hub.html">2. The Docker Hub</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="docker-desktop.html">3. Docker Desktop</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="docker-cli-toolkit.html">4. Building our Docker CLI toolkit</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="docker-cli-advanced.html">5. Using the full power of the Docker CLI</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="creating-container-images.html">6. Creating Your Own Container Images</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="advanced-containers.html">7. Creating More Complex Container Images</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>

                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-introduction"><p>Content from <a href="introduction.html">Introducing Containers</a></p>
<hr>
<p>Last updated on 2024-10-15 |

        <a href="https://github.com/UoMResearchIT/docker-introduction/edit/main/episodes/introduction.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are containers, and why might they be useful to me?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Show how software depending on other software leads to configuration
management problems.</li>
<li>Identify the problems that software installation can pose for
research.</li>
<li>Explain the advantages of containerization.</li>
<li>Explain how using containers can solve software configuration
problems</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="learning-about-docker-containers" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="learning-about-docker-containers" class="callout-inner">
<h3 class="callout-title">Learning about Docker Containers</h3>
<div class="callout-content">
<p>The Australian Research Data Commons has produced a short
introductory video about Docker containers that covers many of the
points below. Watch it before or after you go through this section to
reinforce your understanding!</p>
<p><em><a href="https://www.youtube.com/watch?v=HelrQnm3v4g" class="external-link">How can
software containers help your research?</a></em> Australian Research
Data Commons, 2021. DOI: <a href="https://doi.org/10.5281/zenodo.5091260" class="external-link">10.5281/zenodo.5091260</a></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="scientific-software-challenges">Scientific Software Challenges<a class="anchor" aria-label="anchor" href="#scientific-software-challenges"></a>
</h3>
<div id="whats-your-experience" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="whats-your-experience" class="callout-inner">
<h3 class="callout-title">What’s Your Experience?</h3>
<div class="callout-content">
<p>Take a minute to think about challenges that you have experienced in
using scientific software (or software in general!) for your research.
Then, share with your neighbors and try to come up with a list of common
gripes or challenges.</p>
</div>
</div>
</div>
<p>You may have come up with some of the following:</p>
<ul>
<li>you want to use software that doesn’t exist for the operating system
(Mac, Windows, Linux) you’d prefer.</li>
<li>you struggle with installing a software tool because you have to
install a number of other dependencies first. Those dependencies, in
turn, require <em>other</em> things, and so on (i.e. combinatoric
explosion).</li>
<li>the software you’re setting up involves many dependencies and only a
subset of all possible versions of those dependencies actually works as
desired.</li>
<li>you’re not actually sure what version of the software you’re using
because the install process was so circuitous.</li>
<li>you and a colleague are using the same software but get different
results because you have installed different versions and/or are using
different operating systems.</li>
<li>you installed everything correctly on your computer but now need to
install it on a colleague’s computer/campus computing cluster/etc.</li>
<li>you’ve written a package for other people to use but a lot of your
users frequently have trouble with installation.</li>
<li>you need to reproduce a research project from a former colleague and
the software used was on a system you no longer have access to.</li>
</ul>
<p>A lot of these characteristics boil down to one fact: the main
program you want to use likely depends on many, many, different other
programs (including the operating system!), creating a very complex, and
often fragile system. One change or missing piece may stop the whole
thing from working or break something that was already running. It’s no
surprise that this situation is sometimes informally termed “dependency
hell”.</p>
<div id="software-and-science" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="software-and-science" class="callout-inner">
<h3 class="callout-title">Software and Science</h3>
<div class="callout-content">
<p>Again, take a minute to think about how the software challenges we’ve
discussed could impact (or have impacted!) the quality of your work.
Share your thoughts with your neighbors. What can go wrong if our
software doesn’t work?</p>
</div>
</div>
</div>
<p>Unsurprisingly, software installation and configuration challenges
can have negative consequences for research:</p>
<ul>
<li>you can’t use a specific tool at all, because it’s not available or
installable.</li>
<li>you can’t reproduce your results because you’re not sure what tools
you’re actually using.</li>
<li>you can’t access extra/newer resources because you’re not able to
replicate your software set up.</li>
<li>others cannot validate and/or build upon your work because they
cannot recreate your system’s unique configuration.</li>
</ul>
<p>Thankfully there are ways to get underneath (a lot of) this mess:
containers to the rescue! Containers provide a way to package up
software dependencies and access to resources such as files and
communications networks in a uniform manner.</p>
</div>
<section><h2 class="section-heading" id="what-is-a-container-what-is-docker">What is a Container? What is Docker?<a class="anchor" aria-label="anchor" href="#what-is-a-container-what-is-docker"></a>
</h2>
<hr class="half-width">
<p><a href="https://www.docker.com/" class="external-link">Docker</a> is a tool that allows
you to build what are called “containers.” It’s not the only tool that
can create containers, but is the one we’ve chosen for this workshop.
But what <em>is</em> a container?</p>
<p>To understand containers, let’s first talk briefly about your
computer.</p>
<p>Your computer has some standard pieces that allow it to work – often
what’s called the hardware. One of these pieces is the CPU or processor;
another is the amount of memory or RAM that your computer can use to
store information temporarily while running programs; another is the
hard drive, which can store information over the long-term. All these
pieces work together to do the “computing” of a computer, but we don’t
see them because they’re hidden from view (usually).</p>
<p>Instead, what we see is our desktop, program windows, different
folders, and files. These all live in what’s called the filesystem.
Everything on your computer – programs, pictures, documents, the
operating system itself – lives somewhere in the filesystem.</p>
<p>NOW, imagine you want to install some new software but don’t want to
take the chance of making a mess of your existing system by installing a
bunch of additional stuff (libraries/dependencies/etc.). You don’t want
to buy a whole new computer because it’s too expensive. What if,
instead, you could have another independent filesystem and running
operating system that you could access from your main computer, and that
is actually stored within this existing computer?</p>
<p>Or, imagine you have two tools you want to use in your groundbreaking
research on cat memes: <code>PurrLOLing</code>, a tool that does
AMAZINGLY well at predicting the best text for a meme based on the cat
species and <code>WhiskerSpot</code>, the only tool available for
identifying cat species from images. You want to send cat pictures to
<code>WhiskerSpot</code>, and then send the species output to
<code>PurrLOLing</code>. But there’s a problem: <code>PurrLOLing</code>
only works on Ubuntu and <code>WhiskerSpot</code> is only supported for
OpenSUSE so you can’t have them on the same system! Again, we really
want another filesystem (or two) on our computer that we could use to
chain together <code>WhiskerSpot</code> and <code>PurrLOLing</code> in a
“pipeline”…</p>
<p>Container systems, like Docker, are special programs on your computer
that make it possible! The term “container” can be usefully considered
with reference to shipping containers. Before shipping containers were
developed, packing and unpacking cargo ships was time consuming and
error prone, with high potential for different clients’ goods to become
mixed up. Just like shipping containers keep things together that should
stay together, software containers standardize the description and
creation of a complete software system: you can drop a container into
any computer with the container software installed (the ‘container
host’), and it should “just work”.</p>
<div id="virtualization" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="virtualization" class="callout-inner">
<h3 class="callout-title">Virtualization</h3>
<div class="callout-content">
<p>Containers are an example of what’s called
<strong>virtualization</strong> – having a second “virtual” computer
running and accessible from a main or <strong>host</strong> computer.
Another example of virtualization are <strong>virtual machines</strong>
or VMs. A virtual machine typically contains a whole copy of an
operating system in addition to its own filesystem and has to get booted
up in the same way a computer would. A container is considered a
lightweight version of a virtual machine; underneath, the container is
(usually) using the Linux kernel and simply has some flavour of Linux +
the filesystem inside.</p>
</div>
</div>
</div>
<p>One final term: while the <strong>container</strong> is an
alternative filesystem layer that you can access and run from your
computer, the <strong>container image</strong> is the ‘recipe’ or
template for a container. The container image has all the required
information to start up a running copy of the container. A running
container tends to be transient and can be started and shut down. The
container image is more long-lived, as a definition for the container.
You could think of the container image like a cookie cutter – it can be
used to create multiple copies of the same shape (or container) and is
relatively unchanging, where cookies come and go. If you want a
different type of container (cookie) you need a different container
image (cookie cutter).</p>
</section><section><h2 class="section-heading" id="putting-the-pieces-together">Putting the Pieces Together<a class="anchor" aria-label="anchor" href="#putting-the-pieces-together"></a>
</h2>
<hr class="half-width">
<p>Think back to some of the challenges we described at the beginning.
The many layers of scientific software installations make it hard to
install and re-install scientific software – which ultimately, hinders
reliability and reproducibility.</p>
<p>But now, think about what a container is – a self-contained,
complete, separate computer filesystem. What advantages are there if you
put your scientific software tools into containers?</p>
<p>This solves several of our problems:</p>
<ul>
<li>documentation – there is a clear record of what software and
software dependencies were used, from bottom to top.</li>
<li>portability – the container can be used on any computer that has
Docker installed – it doesn’t matter whether the computer is Mac,
Windows or Linux-based.</li>
<li>reproducibility – you can use the exact same software and
environment on your computer and on other resources (like a large-scale
computing cluster).</li>
<li>configurability – containers can be sized to take advantage of more
resources (memory, CPU, etc.) on large systems (clusters) or less,
depending on the circumstances.</li>
</ul>
<p>The rest of this workshop will show you how to download and run
containers from pre-existing container images on your own computer, and
how to create and share your own container images.</p>
</section><section><h2 class="section-heading" id="use-cases-for-containers">Use cases for containers<a class="anchor" aria-label="anchor" href="#use-cases-for-containers"></a>
</h2>
<hr class="half-width">
<p>Now that we have discussed a little bit about containers – what they
do and the issues they attempt to address – you may be able to think of
a few potential use cases in your area of work. Some examples of common
use cases for containers in a research context include:</p>
<ul>
<li>Using containers solely on your own computer to use a specific
software tool or to test out a tool (possibly to avoid a difficult and
complex installation process, to save your time or to avoid dependency
hell).</li>
<li>Creating a <code>Dockerfile</code> that generates a container image
with software that you specify installed, then sharing a container image
generated using this Dockerfile with your collaborators for use on their
computers or a remote computing resource (e.g. cloud-based or HPC
system).</li>
<li>Archiving the container images so you can repeat analysis/modelling
using the same software and configuration in the future – capturing your
workflow.</li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Almost all software depends on other software components to
function, but these components have independent evolutionary paths.</li>
<li>Small environments that contain only the software that is needed for
a given task are easier to replicate and maintain.</li>
<li>Critical systems that cannot be upgraded, due to cost, difficulty,
etc. need to be reproduced on newer systems in a maintainable and
self-documented way.</li>
<li>Virtualization allows multiple environments to run on a single
computer.</li>
<li>Containerization improves upon the virtualization of whole computers
by allowing efficient management of the host computer’s memory and
storage resources.</li>
<li>Containers are built from ‘recipes’ that define the required set of
software components and the instructions necessary to build/install them
within a container image.</li>
<li>Docker is just one software platform that can create containers and
the resources they use.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-docker-hub"><p>Content from <a href="docker-hub.html">The Docker Hub</a></p>
<hr>
<p>Last updated on 2024-10-15 |

        <a href="https://github.com/UoMResearchIT/docker-introduction/edit/main/episodes/docker-hub.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>One of the reasons why Docker is useful is that there is a lot of
content (container images) already prepared to be used. Each container
image represents a complete software installation that you can use and
access without any extra work!</p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is the Docker Hub, and why is it useful?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explore the Docker Hub webpage for a popular Docker container
image.</li>
<li>Find the list of tags for a particular Docker container image.</li>
<li>Identify the three components of a container image’s
identifier.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>A lot of these images are hosted in the Docker Hub.</p>
<section><h2 class="section-heading" id="introducing-the-docker-hub">Introducing the Docker Hub<a class="anchor" aria-label="anchor" href="#introducing-the-docker-hub"></a>
</h2>
<hr class="half-width">
<p>The Docker Hub is an online repository of container images, a vast
number of which are publicly available. A large number of the container
images are curated by the developers of the software that they package.
Also, many commonly used pieces of software that have been containerized
into images are officially endorsed, which means that you can trust the
container images to have been checked for functionality, stability, and
that they don’t contain malware.</p>
<div id="docker-can-be-used-without-connecting-to-the-docker-hub" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="docker-can-be-used-without-connecting-to-the-docker-hub" class="callout-inner">
<h3 class="callout-title">Docker can be used without connecting to the Docker Hub</h3>
<div class="callout-content">
<p>Note that while the Docker Hub is well integrated into Docker
functionality, the Docker Hub is certainly not required for all types of
use of Docker containers. For example, some organizations may run
container infrastructure that is entirely disconnected from the
Internet.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="exploring-an-example-docker-hub-page">Exploring an example Docker Hub page<a class="anchor" aria-label="anchor" href="#exploring-an-example-docker-hub-page"></a>
</h2>
<hr class="half-width">
<p>As an example of a Docker Hub page, let’s explore the page for the
official Python language container images. Open your web browser to <a href="https://hub.docker.com" class="external-link">https://hub.docker.com</a></p>
<figure><img src="fig/docker-hub/landing.png" alt="Dockerhub_landing" class="figure mx-auto d-block"></figure><p>We will need to register for the later stages of this course, so feel
free to do so now if you are not already.</p>
<p>In the search bar type “python” and hit enter.</p>
<figure><img src="fig/docker-hub/search_python.png" alt="Dockerhub_search" class="figure mx-auto d-block"></figure><p>You should see a list of images related to python. We can immediately
get a feel of the sheer number of container images hosted here. There is
upwards from 10,000 images related to python alone.</p>
<p>There is also some useful information that can help us choose the
image that we want, which we will point out in a moment.</p>
<p>For now, lets go to the top result, the <a href="https://hub.docker.com/_/python" class="external-link">python</a> container image (which
is endorsed by the Docker team) to see what is on a typical Docker Hub
software page.</p>
<figure><img src="fig/docker-hub/python.png" alt="Dockerhub_python" class="figure mx-auto d-block"></figure><p>The top-left provides information about the name, short description,
popularity (i.e., more than a billion downloads in the case of this
container image), and endorsements.</p>
<p>The top-right provides the command to pull this container image to
your computer.</p>
<p>The main body of the page contains many used headings, such as:</p>
<ul>
<li>Which tags (i.e., container image versions) are supported.</li>
<li>Summary information about where to get help, which computer
architectures are supported, etc.</li>
<li>A longer description of the container image.</li>
<li>Examples of how to use the container image.</li>
<li>The license that applies.</li>
</ul>
<p>The “How to use the image” section of most container images’ pages
will provide examples that are likely to cover your intended use of the
container image.</p>
</section><section><h2 class="section-heading" id="container-image-versions-and-owners">Container Image versions and owners<a class="anchor" aria-label="anchor" href="#container-image-versions-and-owners"></a>
</h2>
<hr class="half-width">
<p>A single Docker Hub page can have many different versions of
container images, based on the version of the software inside. These
versions are indicated by “tags”. When referring to the specific version
of a container image by its tag, you use a colon, <code>:</code>, like
this:</p>
<pre><code><span><span class="va">CONTAINER_IMAGE_NAME</span><span class="op">:</span><span class="va">TAG</span></span></code></pre>
<p>If we click the version tag for <code>alpine3.18</code> of this
image, Docker Hub shows it as <code>python:alpine3.18</code></p>
<figure><img src="fig/docker-hub/python_alpine318.png" alt="Dockerhub_python" class="figure mx-auto d-block"></figure><p>The default tag (which is used if you don’t specify one) is called
<code>latest</code>.</p>
<p>This container image is a “Docker Official Image”, which means that
the docker team mantains it and guarantees it. However, it’s equally
common to use container images that have been produced by individual
owners or organizations. Container images that you create and upload to
Docker Hub would fall into this category, as would the container images
maintained by organizations like <a href="https://hub.docker.com/u/continuumio" class="external-link">ContinuumIO</a> (the folks
who develop the Anaconda Python environment) or community groups like <a href="https://hub.docker.com/u/rocker" class="external-link">rocker</a>, a group that builds
community R container images.</p>
<p>In these cases, the “owner”, that is the group- or individual- that
manage the container image is part of the image name, and it is given in
the format:</p>
<pre><code><span><span class="va">OWNER</span><span class="op">/</span><span class="va">CONTAINER_IMAGE_NAME</span><span class="op">:</span><span class="va">TAG</span></span></code></pre>
<p>as can be seen in these examples</p>
<p><br></p>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  rocker/tidyverse:latest
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<figure><img src="fig/docker-hub/tidyverse.gif" alt="rocker/tidyverse:latest" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  mathworks/matlab:r2022b
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<figure><img src="fig/docker-hub/matlab.gif" alt="mathworks/matlab" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  continuumio/anaconda3:master
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<figure><img src="fig/docker-hub/anaconda.gif" alt="continuumio/anaconda3" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="repositories" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="repositories" class="callout-inner">
<h3 class="callout-title">Repositories</h3>
<div class="callout-content">
<p>The technical name for the contents of a Docker Hub page is a
“repository.” The tag indicates the specific version of the container
image that you’d like to use from a particular repository. So a slightly
more accurate version of the above example is:</p>
<pre><code><span><span class="va">OWNER</span><span class="op">/</span><span class="va">REPOSITORY</span><span class="op">:</span><span class="va">TAG</span></span></code></pre>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="choosing-container-images-on-docker-hub">Choosing Container Images on Docker Hub<a class="anchor" aria-label="anchor" href="#choosing-container-images-on-docker-hub"></a>
</h2>
<hr class="half-width">
<p>Note that anyone can create an account on Docker Hub and share
container images there, so it’s important to exercise caution when
choosing a container image on Docker Hub. These are some indicators that
a container image on Docker Hub is consistently maintained, functional
and secure:</p>
<ul>
<li>The container image is updated regularly.</li>
<li>The container image associated with a well established company,
community, or other group that is well-known. Docker helps with badges
to mark official images, verified publishers and sponsored open source
software.</li>
<li>There is a Dockerfile or other listing of what has been installed to
the container image.</li>
<li>The container image page has documentation on how to use the
container image.</li>
<li>The container image is used by the wider community. The graph on the
right at the search page can help with this.</li>
</ul>
<p>If a container image is never updated, created by a random person,
and does not have a lot of metadata, it is probably worth skipping over.
Even if such a container image is secure, it is not reproducible and not
a dependable way to run research computations.</p>
</section><section><h2 class="section-heading" id="other-sources-of-container-images">Other sources of Container Images<a class="anchor" aria-label="anchor" href="#other-sources-of-container-images"></a>
</h2>
<hr class="half-width">
<p>Although many of the containers made for docker are hosted in the
Docker Hub, there are other places where these can be distributed,
including (but not limited to):</p>
<ul>
<li>
<a href="https://github.com/features/packages" class="external-link">GHCR</a> from
Github.</li>
<li>
<a href="https://quay.io/" class="external-link">Quay</a> from Red Hat.</li>
<li>
<a href="https://cloud.google.com/artifact-registry" class="external-link">Artifact
Registry</a> from Google.</li>
<li>
<a href="https://docs.gitlab.com/ee/user/packages/container_registry/" class="external-link">GLR</a>
from GitLab.</li>
<li>
<a href="https://aws.amazon.com/ecr/" class="external-link">ECR</a> from Amazon.</li>
<li>
<a href="https://azure.microsoft.com/en-us/products/container-registry" class="external-link">ACR</a>
from Azuere, Microsoft.</li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>The Docker Hub is an online repository of container images.</li>
<li>Many Docker Hub container images are public, and may be officially
endorsed.</li>
<li>Each Docker Hub page about a container image provides structured
information and subheadings</li>
<li>Most Docker Hub pages about container images contain sections that
provide examples of how to use those container images.</li>
<li>Many Docker Hub container images have multiple versions, indicated
by tags.</li>
<li>The naming convention for Docker container images is:
<code>OWNER/CONTAINER_IMAGE_NAME:TAG</code>
</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-docker-desktop"><p>Content from <a href="docker-desktop.html">Docker Desktop</a></p>
<hr>
<p>Last updated on 2024-10-15 |

        <a href="https://github.com/UoMResearchIT/docker-introduction/edit/main/episodes/docker-desktop.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p><strong>This episode is meant to be demonstrative, that is, you do
not <em>need</em> to follow along.</strong></p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is Docker Desktop?</li>
<li>What can it be used for?</li>
<li>Why can’t it replace the cli?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Show Docker Desktop and its components.</li>
<li>Understand what images and containers are.</li>
<li>Visualize the process of image aquisition, container execution and
where it ends.</li>
<li>Understand the ephimeral nature of containers.</li>
<li>Have a glimpse at containers that allow interaction.</li>
<li>Understand the importance of cleaning up in docker.</li>
<li>Understand the limitations of Docker Desktop.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>We will present the Docker Desktop dashboard, as it will be useful to
understand key concepts of docker, such as images and containers.
However, it is important to note that while it is mostly is free, some
features are offered at a premium. Also, it is not fully functional on
all operating systems; it can produce conflicts with the docker engine
on Linux, for example.</p>
<section><h2 class="section-heading" id="getting-images">Getting images<a class="anchor" aria-label="anchor" href="#getting-images"></a>
</h2>
<hr class="half-width">
<p>Setting up docker in Windows or Mac will have installed Docker
Desktop by default. If you open the application you will likely see
something like this: <img src="fig/docker-desktop/00_lo.gif" alt="Docker Desktop being opened for the first time." class="figure"></p>
<p>You’ll notice that the panel on the left has a tab for ‘Images’ and
another for ‘Containers’. These will be the focus for the episode, and
we will ignore most other features.</p>
<p>On the top you’ll also find a search icon, which links to Docker Hub,
and allows us to search for the images we saw in the previous episode
directly from here.</p>
<p>*Note that there are two tabs, one for containers and one for images.
Make sure that you select the right tab when you search! <img src="fig/docker-desktop/01_search.png" alt="Search window." class="figure"></p>
<p>In Docker Desktop you can either search by name only, <img src="fig/docker-desktop/02_search_name.png" alt="Search by name." class="figure"></p>
<p>or include the owner. You can then select the tag from the dropdown
menu. <img src="fig/docker-desktop/03_search_owner%26tag.png" alt="Search with owner and select a tag." class="figure"></p>
<p>Once you find the image you were looking for, you can either download
it (pull), or directly run it.</p>
<p>We’ll start by downloading the latest versions of
<code>hello-world</code>, <code>docker/getting-started</code> and
<code>alpine</code>.</p>
</section><section><h2 class="section-heading" id="inspecting-images">Inspecting images<a class="anchor" aria-label="anchor" href="#inspecting-images"></a>
</h2>
<hr class="half-width">
<p>The ‘Images’ tab on the left panel will show all the images in your
system, so you will be able to see them here. <img src="fig/docker-desktop/04_pulled_3.png" alt="Images list, hello-world, getting-started and alpine." class="figure"></p>
<p>From this tab we can see some information about the images on disk,
and run them, but we can also inspect the images. Clicking on the image
will open a window with information on how the image is built, and
examine its packages and vulnerabilities. <img src="fig/docker-desktop/05_image_inspection.png" alt="Inspecting image hello-world." class="figure"></p>
<p>The <code>hello-world</code> image does not seem too interesting from
here. If you go to DockerHub you’ll find links to the Github site, where
you’ll see that the image is not as simple as it looks. Nevertheless,
this is a very nice and quick way to explore an image.</p>
<p>If we now inspect the <code>docker/getting-started</code> image, for
example, we can see that it detects some vulnerabilities: <img src="fig/docker-desktop/06_image_inspection_gs.png" alt="Inspecting image getting-started." class="figure"></p>
<p>You can even further inspect the vulnerable layers by looking at the
command <img src="fig/docker-desktop/07_image_inspection_gs_2.png" alt="Inspecting image command in getting-started." class="figure"></p>
<p>This all looks rather scary, and it is important that we are careful
with the images that we download. It is therefore quite useful to be
able to analize them like this. This image, in particular, is from a
verified publisher (Docker Inc. no less!), and has been downloaded over
10M times, so the container is likely not maliicous.</p>
</section><section><h2 class="section-heading" id="running-containers">Running containers<a class="anchor" aria-label="anchor" href="#running-containers"></a>
</h2>
<hr class="half-width">
<p>The images that we just downloaded are immutable files, they are
snapshots of an environment, distributed to be used as
<em>templates</em> to create ‘containers’. The containers are,
essentially, images being <em>run</em>. They are executions of the
image, and because they are running, they are no longer ‘static’.</p>
<p>Let’s run the <code>hello-world</code> image by either clicking the
‘Run’ button in the ‘Actions’ column, from the Images tab. <img src="fig/docker-desktop/08_image_run.png" alt="Run button from Images tab." class="figure"></p>
<p>A prompt will ask you to confirm ‘Run’ or modify some optional
settings. <img src="fig/docker-desktop/09_image_run_prompt.png" alt="Run confirmation prompt." class="figure"></p>
<p>The optional settings allow you to modify the container’s name, so
that you can easily identify it afterwards. Lets add an appropriate name
and confirm with the ‘Run’ button. <img src="fig/docker-desktop/10_optional_settings.png" alt="Run optional settings." class="figure"></p>
<p>You will likely be taken to a ‘Logs’ tab inside the container that
you just ran. The logs show the output of this particular image, ‘Hello
from Docker!’ among other things.</p>
<p>If you look carefully, the ‘Containers’ tab on the left is
highlighted. We are looking at a container now, not an image, and so we
were re-located.</p>
<p>Exploring the ‘Inspect’ tab will show us some information, but for
now we are more interested in what the ‘Terminal’ and ‘Stats’ tabs have
to say. They both seem to indicate that we need to <em>run</em> or
<em>start</em> the container.</p>
<p><br></p>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Logs tab
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/11_hello_log.png" alt="Logs tab in container from hello-world image." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Inspect tab
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/12_hello_inspect.png" alt="Inspect tab in container from hello-world image." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Terminal tab
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/14_hello_terminal.png" alt="Terminal tab in container from hello-world image." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">
  Stats tab
  </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/13_hello_stats.png" alt="Stats tab in container from hello-world image." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<p>Indeed, if we look carefully, we will find an ‘Exited (0)’ status
under the container name, and a ‘Start’ button near the top-right
corner. However, if we click on that button we will see the output
duplicated in the logs, and the ‘Exited (0)’ status again. <img src="fig/docker-desktop/15_hello_start.png" alt="Clickling Start on the already run hello-world container." class="figure"></p>
<p>If we go back to the images tab and run the image again (let’s not
bother giving it a name this time), we’ll see that the same thing
hapens. We get the ‘Hello from Docker!’, and the container exits. <img src="fig/docker-desktop/16_hello_2.png" alt="Running hello-world image for a second time." class="figure"></p>
<p>The nature of most containers is <em>ephimeral</em>. They are meant
to execute a process, and when the process is completed, they exit. We
can confirm this by clicking on the ‘Containers’ tab on the left. This
will exit the container inspection and show us all the containers. Both
containers in the list have a status ‘Exited’. <img src="fig/docker-desktop/17_containers.png" alt="Containers list." class="figure"></p>
<p>You may be wondering why if we have only run the
<code>hello-world</code> image, you can see there are two containers.
One of the containers we named, and the other has some gibberish as a
name (Docker generated this randomly). As mentioned before, the
<em>image</em> is used as a template, and as many <em>containers</em> as
we want can be created from it. If we go back to the ‘Images’ tab and
run <code>hello world</code> again, we’ll see a new container
appear.</p>
</section><section><h2 class="section-heading" id="interacting-with-containers">Interacting with containers<a class="anchor" aria-label="anchor" href="#interacting-with-containers"></a>
</h2>
<hr class="half-width">
<p>Not all containers are as short lived as the one we’ve been using. If
we run the <code>docker/getting-started</code> image that we had pulled
earlier, we will see something different happen. You can immediately
notice the status under the container name is ‘RUNNING’ now. nal
<em>inside</em> the container.</p>
<p>The ‘Logs’ tab is not too informative, but the ‘Inspect’ tab already
shows more information. A process called ‘nginx’ is running. The
‘Terminal’ and ‘Stats’ tabs changed the most. Since the container is
still running, the stats get shown, and we are able to launch a
termi</p>
<p><br></p>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">
  Logs tab
  </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/18_gettingstarted_log.png" alt="Logs tab in container from getting-started image." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">
  Inspect tab
  </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/19_gettingstarted_inspect.png" alt="Inspect tab in container from getting-started image." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7">
  Terminal tab
  </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" aria-labelledby="headingSolution7" data-bs-parent="#accordionSolution7">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/20_gettingstarted_terminal.png" alt="Terminal tab in container from getting-started image." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8">
  Stats tab
  </h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" aria-labelledby="headingSolution8" data-bs-parent="#accordionSolution8">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/21_gettingstarted_stats.png" alt="Stats tab in container from getting-started image." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<p>Before trying to do anything in the terminal, let’s look at the
container list by clicking on the ‘Containers’ tab on the left. You’ll
see the green icon of the container indicating that it is still live,
and indication of how long it’s been running for. <img src="fig/docker-desktop/22_gettingstarted_containers.png" alt="Containers list, getting-started still running." class="figure"></p>
<p>Clicking on the container name again will take us back to the ‘Logs’
tab in the container. Lets try and interact with the terminal inside the
container. If you print the working directory with <code>pwd</code>
you’ll get the base directory: <code>/</code>. You can also list the
contents with <code>ls</code>, and the <code>docker-entrypoint</code>
files are a dead giveaway that we are inside the container. At this
point this container is very much like a VM. We can modify things, like
for example making a directory with <code>mkdir</code>, and see it has
been created with <code>ls</code> again. <img src="fig/docker-desktop/23_gettingstarted_mkdir.png" alt="Terminal, mkdir and ls inside getting-started container." class="figure"></p>
<p>But we can do more than that, we can install things. For example,
you’ll notice that <code>htop</code> is not installed. Since the
<code>getting-started</code> image is based on Alpine, we can install it
using <code>apk add htop</code>, and we can now use it.</p>
<p><br></p>
<div id="accordionSolution9" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution9" aria-expanded="false" aria-controls="collapseSolution9">
  <h4 class="accordion-header" id="headingSolution9">
  Installing htop
  </h4>
</button>
<div id="collapseSolution9" class="accordion-collapse collapse" aria-labelledby="headingSolution9" data-bs-parent="#accordionSolution9">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/24_gettingstarted_htop.png" alt="Terminal, installing htop inside getting-started container." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution10" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution10" aria-expanded="false" aria-controls="collapseSolution10">
  <h4 class="accordion-header" id="headingSolution10">
  Running htop
  </h4>
</button>
<div id="collapseSolution10" class="accordion-collapse collapse" aria-labelledby="headingSolution10" data-bs-parent="#accordionSolution10">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/25_gettingstarted_htop2.png" alt="Terminal, running htop inside getting-started container." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<p>The container does not need to stay alive forever, and you can see
that there is a ‘stop’ icon on the top right. If we stop the container,
we get a familiar empty tab in ‘Terminal’ and ‘Stats’. The ‘Containers’
tab on the left will also show the container status as ‘Exited’</p>
<p><br></p>
<div id="accordionSolution11" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution11" aria-expanded="false" aria-controls="collapseSolution11">
  <h4 class="accordion-header" id="headingSolution11">
  Terminal tab
  </h4>
</button>
<div id="collapseSolution11" class="accordion-collapse collapse" aria-labelledby="headingSolution11" data-bs-parent="#accordionSolution11">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/26_gettingstarted_exited_t.png" alt="Terminal tab in container from stopped getting-started image." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution12" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution12" aria-expanded="false" aria-controls="collapseSolution12">
  <h4 class="accordion-header" id="headingSolution12">
  Stats tab
  </h4>
</button>
<div id="collapseSolution12" class="accordion-collapse collapse" aria-labelledby="headingSolution12" data-bs-parent="#accordionSolution12">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/27_gettingstarted_exited_s.png" alt="Stats tab in container from stopped getting-started image." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution13" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution13" aria-expanded="false" aria-controls="collapseSolution13">
  <h4 class="accordion-header" id="headingSolution13">
  Container list
  </h4>
</button>
<div id="collapseSolution13" class="accordion-collapse collapse" aria-labelledby="headingSolution13" data-bs-parent="#accordionSolution13">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/28_gettingstarted_exited_c.png" alt="Container list after stopping getting-started image." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<p>Now lets say I want to run the <code>getting-started</code> image
again. So I go to the ‘Images’ tab, and click run. Now lets go to the
‘Terminal’ tab, and try and find our directory with <code>ls</code>. The
directory is not there. We’d also installed <code>htop</code>. so lets
have a go at running it. Not there either. <img src="fig/docker-desktop/29_gettingstarted_2.png" alt="Terminal in fresh getting-started image." class="figure"></p>
<p>When we re-ran the <em>image</em>, we created a <strong>new</strong>
<em>container</em>. The new container is created from the template saved
in the image, and so ‘our’ changes have banished. This becomes very
clear when we go back to the ‘Containers’ tab on the left. We can see
that the first container we created from the
<code>getting-started</code> image is there, next to the new container
(which is still running, by the way). <img src="fig/docker-desktop/30_gettingstarted_2_containers.png" alt="Containers after new run of getting-started image." class="figure"></p>
</section><section><h2 class="section-heading" id="reviving-containers">Reviving containers<a class="anchor" aria-label="anchor" href="#reviving-containers"></a>
</h2>
<hr class="half-width">
<p>We <em>can</em> get the old container running again, although this is
rarely something we’d <em>want</em> to do. In Docker Desktop, all we
need to do is click on the ‘Start’ button from the ‘Containers’ list.
The terminal will appear empty, because it is a new session, but you
will even be able to ‘recall’ commands. <img src="fig/docker-desktop/31-32.gif" alt="Reviving container getting-started." class="figure"></p>
</section><section><h2 class="section-heading" id="cleaning-up">Cleaning up<a class="anchor" aria-label="anchor" href="#cleaning-up"></a>
</h2>
<hr class="half-width">
<p>The <code>hello-world</code> image was nice and useful to test docker
was working, but it is now rather useless. If I want to delete it, the
‘Images’ tab on the left has a convenient bin icon to do so. Clicking on
it will prompt you for confirmation, but it will fail. <img src="fig/docker-desktop/33-35.gif" alt="Failing to delete image." class="figure"></p>
<p>You’ll probably notice that the status of the image is ‘In use’. That
seems strange though, given that all the containers from that image
excited immediately.</p>
<p>Lets have a look at the ‘Containers’ tab. It shows a list of 5
containers now. Three of them came from the <code>hello-world</code>
image, and are stopped. Two of them came from the
<code>getting-started</code> image, and are running.</p>
<p>We’ve only been using Docker for 15 minutes though! You may see how
this can become a problem… Particularly so because we were a bit sloppy
and did not name the containers. Let’s try and get rid of the containers
then. We can conveniently select them all with the tickbox at the top,
and an option to ‘Delete’ shows up. Clicking on it will prompt for
confirmation, and we can go ahead and accept. <img src="fig/docker-desktop/36-38.gif" alt="Deleting containers." class="figure"></p>
<p>All our containers are now gone. Forever.</p>
<p><strong><em>Warning:</em></strong> You have to be careful here, this
action deleted even the containers that were running. You can filter the
containers before you select them “all”.</p>
<p>On the up-side, the ‘Images’ tab shows both the
<code>hello-world</code> and the <code>getting-started</code> images as
‘Unused’ now. For docker, an image is ‘In use’ as long as at least one
container has been created from it. We have just deleted all the
containers created from either of these images. This tells Docker that
they are no longer being used, and can therefore be safely deleted. <img src="fig/docker-desktop/39-42.gif" alt="Successfully deleting images." class="figure"></p>
</section><section><h2 class="section-heading" id="limitations---why-not-docker-desktop">Limitations - Why not Docker Desktop?<a class="anchor" aria-label="anchor" href="#limitations---why-not-docker-desktop"></a>
</h2>
<hr class="half-width">
<p>We have seen many of the neat and functional bits of Docker Desktop,
and it can be mighty appealing, particularly if you lean towards the use
of graphical interfaces. However, we’ve not touched on its weaknesses.
We’ll just need to point at one to feel the need to throw everything
overboard.</p>
<p>Let’s go ahead and run the only image we have already pulled,
<code>alpine</code>. <img src="fig/docker-desktop/43_alpine.png" alt="Logs tab in container from alpine image." class="figure"></p>
<p>That was fast, and uneventful. Not even a single output to the
‘Logs’. No way to open a terminal inside Alpine.</p>
<p><br></p>
<div id="accordionSolution14" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution14" aria-expanded="false" aria-controls="collapseSolution14">
  <h4 class="accordion-header" id="headingSolution14">
  Logs tab
  </h4>
</button>
<div id="collapseSolution14" class="accordion-collapse collapse" aria-labelledby="headingSolution14" data-bs-parent="#accordionSolution14">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/44_alpine_logs.png" alt="Logs tab in container from alpine image." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution15" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution15" aria-expanded="false" aria-controls="collapseSolution15">
  <h4 class="accordion-header" id="headingSolution15">
  Inspect tab
  </h4>
</button>
<div id="collapseSolution15" class="accordion-collapse collapse" aria-labelledby="headingSolution15" data-bs-parent="#accordionSolution15">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/45_alpine_i.png" alt="Inspect tab in container from alpine image." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution16" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution16" aria-expanded="false" aria-controls="collapseSolution16">
  <h4 class="accordion-header" id="headingSolution16">
  Terminal tab
  </h4>
</button>
<div id="collapseSolution16" class="accordion-collapse collapse" aria-labelledby="headingSolution16" data-bs-parent="#accordionSolution16">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/46_alpine_t.png" alt="Terminal tab in container from alpine image." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution17" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution17" aria-expanded="false" aria-controls="collapseSolution17">
  <h4 class="accordion-header" id="headingSolution17">
  Stats tab
  </h4>
</button>
<div id="collapseSolution17" class="accordion-collapse collapse" aria-labelledby="headingSolution17" data-bs-parent="#accordionSolution17">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/47_alpine_s.png" alt="Stats tab in container from alpine image." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<p>Just to be clear though, this Docker image does contain the whole
Alpine OS. In Docker Desktop, however, there is no way to interact with
it.</p>
<p>Let’s try something different. There’s a program called
<code>cowsay</code> that lets you print messages as if a cow was saying
them. Searching for that image shows that there is one by
<code>beatrixxx32</code> with a reasonable number of downloads. <img src="fig/docker-desktop/48_cowsay.png" alt="Search of cowsay image." class="figure"></p>
<p>So lets pull that image and run it.</p>
<p><br></p>
<div id="accordionSolution18" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution18" aria-expanded="false" aria-controls="collapseSolution18">
  <h4 class="accordion-header" id="headingSolution18">
  Logs tab
  </h4>
</button>
<div id="collapseSolution18" class="accordion-collapse collapse" aria-labelledby="headingSolution18" data-bs-parent="#accordionSolution18">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/50_cowsay_logs.png" alt="Logs tab in container from cowsay image." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution19" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution19" aria-expanded="false" aria-controls="collapseSolution19">
  <h4 class="accordion-header" id="headingSolution19">
  Inspect tab
  </h4>
</button>
<div id="collapseSolution19" class="accordion-collapse collapse" aria-labelledby="headingSolution19" data-bs-parent="#accordionSolution19">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/51_cowsay_inspect.png" alt="Inspect tab in container from cowsay image." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution20" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution20" aria-expanded="false" aria-controls="collapseSolution20">
  <h4 class="accordion-header" id="headingSolution20">
  Terminal tab
  </h4>
</button>
<div id="collapseSolution20" class="accordion-collapse collapse" aria-labelledby="headingSolution20" data-bs-parent="#accordionSolution20">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/52_cowsay_term.png" alt="Terminal tab in container from cowsay image." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution21" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution21" aria-expanded="false" aria-controls="collapseSolution21">
  <h4 class="accordion-header" id="headingSolution21">
  Stats tab
  </h4>
</button>
<div id="collapseSolution21" class="accordion-collapse collapse" aria-labelledby="headingSolution21" data-bs-parent="#accordionSolution21">
<div class="accordion-body">
<figure><img src="fig/docker-desktop/53_cowsay_stats.png" alt="Stats tab in container from cowsay image." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<p>We do get a cow this time, but it is not saying anything. But it does
not know <em>what</em> to say. Going back to the cowsay image search,
you may notice that in ‘Usage’ the command line asks for “your message”.
We are not using a command though, we just clicked <em>run</em>. Maybe
we missed something in the optional settings! <img src="fig/docker-desktop/54_cowsay_opt.png" alt="Optional settings for cowsay." class="figure"></p>
<p>No, it does not seem like it. No matter what we do, we cannot make
the cow say anything from here.</p>
<p>Are the alpine and cowsay images useless? No, definitely not.
However, they are expecting some sort of input or command, which we
cannot provide from Docker Desktop.</p>
<p>This is the case for most images, and so Docker Desktop (as it is
now) cannot really be used for much more than as a nice dashboard.</p>
<p>In the next episode, we will use docker from the command line, and
all of the advantages it brings will become aparent.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Docker Desktop is a great dashboard that allows us to understand and
visualize the lifecycle of images and containers.</li>
<li>Images are snapshots of an environment, easily distributable and
ready to be used as <em>templates</em> for containers.</li>
<li>Containers are executions of the images, often with configuration
added on top, and usually meant for single use.</li>
<li>Running a container usually implies creating a new copy, so it is
important to clean up regularly.</li>
<li>Docker Desktop could potentially be all you need to use if you only
<em>consume</em> images out of the box.</li>
<li>However, it is very limited in most cases (even for
<em>consumers</em>), and rarely allows the user to configure and
interact with the containers adequately.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-docker-cli-toolkit"><p>Content from <a href="docker-cli-toolkit.html">Building our Docker CLI toolkit</a></p>
<hr>
<p>Last updated on 2024-10-15 |

        <a href="https://github.com/UoMResearchIT/docker-introduction/edit/main/episodes/docker-cli-toolkit.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>Before we start to tackle Docker tasks that are only possible in the
command line, we need to build up our toolkit of Docker commands that
allow us to perform the same tasks we learned to do in Docker
Desktop.</p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I use the Docker CLI to perform the same tasks we learned to
do in Docker Desktop?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Build our fundamental Docker CLI toolkit</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="pulling-and-listing-images">Pulling and Listing Images<a class="anchor" aria-label="anchor" href="#pulling-and-listing-images"></a>
</h2>
<hr class="half-width">
<p>To run an image, first we need to download it. You may remember that,
in Docker, this is known as <em>pulling</em> an image.</p>
<p>Let’s try pulling the SPUC container that we used before:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">docker</span> pull spuacv/spuc:latest</span></code></pre>
</div>
<p>If it is the first time you pull this image, you will see something
like this:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>latest: Pulling from spuacv/spuc
302e3ee49805: Pull complete
6b08635bc459: Pull complete
18bb7c8edce2: Pull complete
8341816e3d13: Pull complete
174a3dce8e2a: Pull complete
67d0d37078fb: Pull complete
4a705a772a90: Pull complete
bd9732a6317b: Pull complete
44c70b826ff3: Pull complete
cee1b3575f12: Pull complete
Digest: sha256:ad219064aaaad76860c53ec8420730d69dc5f8beb9345b0a15176111c2a976c5
Status: Downloaded newer image for spuacv/spuc:latest
docker.io/spuacv/spuc:latest</code></pre>
</div>
<p>If you’d already downloaded it before, you will instead get something
like this:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>latest: Pulling from spuacv/spuc
Digest: sha256:ad219064aaaad76860c53ec8420730d69dc5f8beb9345b0a15176111c2a976c5
Status: Image is up to date for spuacv/spuc:latest
docker.io/spuacv/spuc:latest</code></pre>
</div>
<p>This just means Docker detected you already had that image, so it
didn’t need to download it again.</p>
<p>The structure of the command we just used will be the same for most
of the commands we will use in the Docker CLI, so it is worth taking a
moment to understand it.</p>
<div id="the-structure-of-a-docker-command" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="the-structure-of-a-docker-command" class="callout-inner">
<h3 class="callout-title">The structure of a Docker command</h3>
<div class="callout-content">
<p>The Docker CLI can be intimidating, as it is easy to get very long
commands that take a bit of work to understand. However, when you
understand the structure of the commands it becomes much easier to
understand what is happening.</p>
<p>Let’s dive into the structure of the command we looked at. Here is a
diagram which breaks things down:</p>
<figure><img src="fig/docker_cmd.png" alt="A diagram showing the syntactic structure of a Docker command" class="figure mx-auto d-block"></figure><ul>
<li>Every Docker command starts with ‘docker’</li>
<li>Next, you specify the type of object to act on (e.g. image,
container)</li>
<li>Followed by the action to perform and the name of the object
(e.g. run, pull)</li>
<li>You can also include additional arguments and switches as needed
(e.g. the image name)</li>
</ul>
<div class="section level3">
<h3 id="todo-update-the-diagram-to-use-the-pull-command-instead">TODO: Update the diagram to use the pull command instead!<a class="anchor" aria-label="anchor" href="#todo-update-the-diagram-to-use-the-pull-command-instead"></a>
</h3>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="listing-images">Listing Images<a class="anchor" aria-label="anchor" href="#listing-images"></a>
</h2>
<hr class="half-width">
<p>Now that we have pulled our image, let’s check that it is there:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">docker</span> image ls</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>REPOSITORY                              TAG        IMAGE ID       CREATED         SIZE
spuacv/spuc                             latest    ce72bd42e51c   3 days ago      137MB</code></pre>
</div>
<p>This command lists (ls is short for list) all the images that we have
downloaded. It is the equivalent of the ‘Images’ tab in Docker Desktop.
You should see the SPUC image listed here, along with some other
information about it.</p>
</section><section><h2 class="section-heading" id="inspecting">Inspecting<a class="anchor" aria-label="anchor" href="#inspecting"></a>
</h2>
<hr class="half-width">
<p>You may remember that in Docker Desktop we could explore the image
buildup and the image’s metadata. We called this ‘inspecting’ the image.
To inspect an image using the Docker CLI, we can use:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">docker</span> inspect spuacv/spuc:latest</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[
    {
        "Id": "sha256:ce72bd42e51c049fe29b4c15dc912e88c4461e94c2e1d403b90e2e53dfb1b420",
        "RepoTags": [
            "spuacv/spuc:latest"
        ],
        "RepoDigests": [
            "spuacv/spuc@sha256:ad219064aaaad76860c53ec8420730d69dc5f8beb9345b0a15176111c2a976c5"
        ],
        "Parent": "",
        "Comment": "buildkit.dockerfile.v0",
        "Created": "2024-10-11T14:05:59.254831281+01:00",
        "DockerVersion": "",
        "Author": "",
        "Config": {
[...]</code></pre>
</div>
<p>This tells you <strong>a lot</strong> of details about the image.
This can be useful for understanding what the image does and how it is
configured but it is also quite overwhelming!</p>
<p>The most useful information for an image user is what the container
will do when it is run. We highlighted the <code>command</code> and
<code>entrypoint</code> while inspecting images in Docker Desktop. Let’s
work on getting this information <em>only</em>.</p>
<p>To do that we will refine our command using the <code>-f</code> flag
to specify the output format. Lets try running the following
command:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">docker</span> inspect spuacv/spuc:latest <span class="at">-f</span> <span class="st">"Command: {{.Config.Cmd}}"</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Command: [--units iuhc]</code></pre>
</div>
<p>That’s more manageable! How does it work?</p>
<p>The result of the inspect command is a JSON object, so we can access
elements from the output hierarchically. The <code>command</code> is
part of the image’s <code>Config</code>, which is at the base of the
json object. When we use double curly braces, docker understands we want
to access the value of the key <code>Cmd</code> in the
<code>Config</code> object.</p>
<p>We can do a similar thing to extract the entrypoint:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">docker</span> inspect spuacv/spuc:latest <span class="at">-f</span> <span class="st">"Entrypoint: {{.Config.Entrypoint}}"</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Entrypoint: [python /spuc/spuc.py]</code></pre>
</div>
<p>or even get them both at the same time:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">docker</span> inspect spuacv/spuc:latest <span class="at">-f</span> <span class="st">"Command: {{.Config.Cmd}}\nEntrypoint: {{.Config.Entrypoint}}"</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Command: [--units iuhc]
Entrypoint: [python /spuc/spuc.py]</code></pre>
</div>
<p>Great! So we know what the command and entrypoint are… but what do
they mean?</p>
<div id="default-command" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="default-command" class="callout-inner">
<h3 class="callout-title">Default Command</h3>
<div class="callout-content">
<p>The default command is the command that a container will run when it
is started. The default values are specified by the creator of an image,
but can be overridden when the container is run.</p>
<p>The default command is formed of two parts, the <em>entrypoint</em>
and the <em>command</em>. The two are concatenated to form the full
command.</p>
<div class="section level3">
<h3 id="todo-add-a-diagram-showing-the-structure-of-the-default-command-putting-the-bullet-points-in-the-image-as-you-did-with-the-docker-command-diagram-">TODO: Add a diagram showing the structure of the default command,
putting the bullet points in the image, as you did with the docker
command diagram.<a class="anchor" aria-label="anchor" href="#todo-add-a-diagram-showing-the-structure-of-the-default-command-putting-the-bullet-points-in-the-image-as-you-did-with-the-docker-command-diagram-"></a>
</h3>
<ul>
<li>
<strong>Entrypoint</strong> is usually the base command for the
container. It is not often overwritten.</li>
<li>
<strong>Command</strong> is commonly the set of parameters for the
base command. This is overwritten frequently.</li>
</ul>
<p>In our case, the entrypoint is <code>python /spuc/spuc.py</code> and
the command is <code>--units iuhc</code>. This means that when the
container is run, it will execute the command
<code>python /spuc/spuc.py --units iuhc</code>.</p>
<p>As mentioned, the command is commonly overwritten when the container
is run. This means we could pass different parameters to the python
script when we run the container.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="running">Running<a class="anchor" aria-label="anchor" href="#running"></a>
</h2>
<hr class="half-width">
<p>Now that we have the image, and we know what it will do, let’s run
it!</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">docker</span> run spuacv/spuc:latest</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
            \
             \
              \\
               \\\
                &gt;\/7
            _.-(º   \
           (=___._/` \            ____  ____  _    _  ____
                )  \ |\          / ___||  _ \| |  | |/ ___|
               /   / ||\         \___ \| |_) | |  | | |
              /    &gt; /\\\         ___) |  __/| |__| | |___
             j    &lt; _\           |____/|_|    \____/ \____|
         _.-' :      ``.
         \ r=._\        `.       Space Purple Unicorn Counter
        &lt;`\\_  \         .`-.
         \ r-7  `-. ._  ' .  `\
          \`,      `-.`7  7)   )
           \/         \|  \'  / `-._
                      ||    .'
                       \\  (
                        &gt;\  &gt;
                    ,.-' &gt;.'
                   &lt;.'_.''
                     &lt;'


Welcome to the Space Purple Unicorn Counter!

:::: Units set to Imperial Unicorn Hoove Candles [iuhc] ::::")

:: Try recording a unicorn sighting with:
    curl -X PUT localhost:8321/unicorn_spotted?location=moon\&amp;brightness=100</code></pre>
</div>
<p>And there we have it! The SPUC container is running and ready to
count unicorns. What we are seeing now is the equivalent of the ‘Logs’
tab in Docker Desktop.</p>
<p>The only problem we have though, is that it is ‘blocking’ this
terminal, so we can’t run any more commands until we stop the
container.</p>
<p>Let’s stop the container using <code>[Ctrl+C]</code>, and run it
again, but in the background, ‘detached’ from the terminal, using the
<code>-d</code> flag:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-d</span> spuacv/spuc:latest</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0bb79cbb589652c265552913f6de7992cd996f6da97ecc9ba43672fe34ff5f23</code></pre>
</div>
<p><strong>Note:</strong> The <code>-d</code> flag needs to go in front
of the image name!</p>
<p>But what is happening? We can’t see the output of the container
anymore! Is the container running or not?</p>
</section><section><h2 class="section-heading" id="listing-containers">Listing Containers<a class="anchor" aria-label="anchor" href="#listing-containers"></a>
</h2>
<hr class="half-width">
<p>To see what is happening, we can use the <code>docker ps</code>
command:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="ex">docker</span> ps</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>CONTAINER ID   IMAGE                  COMMAND                  CREATED              STATUS              PORTS        NAMES
0bb79cbb5896   spuacv/spuc:latest     "python /spuc/spuc.p…"   About a minute ago   Up About a minute   8321/tcp     ecstatic_nightingale</code></pre>
</div>
<p>This command lists all the containers that are currently running. It
is the equivalent of the ‘Containers’ tab in Docker Desktop, except that
it only shows running containers. You can see that the SPUC container is
running, and that it has been given a random name
<code>ecstatic_nightingale</code>.</p>
<p>If you want to see all containers, including those that are stopped,
you can use the <code>-a</code> flag:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="ex">docker</span> ps <span class="at">-a</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>CONTAINER ID   IMAGE                  COMMAND                  CREATED              STATUS                       PORTS        NAMES
0bb79cbb5896   spuacv/spuc:latest     "python /spuc/spuc.p…"   About a minute ago   Up About a minute            8321/tcp     ecstatic_nightingale
03ef43deee20   spuacv/spuc:latest     "python /spuc/spuc.p…"   10 minutes ago       Exited (0) 10 minutes ago                 suspicious_beaver</code></pre>
</div>
</section><section><h2 class="section-heading" id="logs">Logs<a class="anchor" aria-label="anchor" href="#logs"></a>
</h2>
<hr class="half-width">
<p>So we know it is running, but we can’t see the output of the
container. We can still access them though, we just need to ask Docker
for the logs:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="ex">docker</span> logs ecstatic_nightingale</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
            \
             \
              \\
               \\\
                &gt;\/7
            _.-(º   \
           (=___._/` \            ____  ____  _    _  ____
                )  \ |\          / ___||  _ \| |  | |/ ___|
               /   / ||\         \___ \| |_) | |  | | |
              /    &gt; /\\\         ___) |  __/| |__| | |___
             j    &lt; _\           |____/|_|    \____/ \____|
         _.-' :      ``.
         \ r=._\        `.       Space Purple Unicorn Counter
        &lt;`\\_  \         .`-.
         \ r-7  `-. ._  ' .  `\
          \`,      `-.`7  7)   )
           \/         \|  \'  / `-._
                      ||    .'
                       \\  (
                        &gt;\  &gt;
                    ,.-' &gt;.'
                   &lt;.'_.''
                     &lt;'


Welcome to the Space Purple Unicorn Counter!

:::: Units set to Imperial Unicorn Hoove Candles [iuhc] ::::")

:: Try recording a unicorn sighting with:
    curl -X PUT localhost:8321/unicorn_spotted?location=moon\&amp;brightness=100</code></pre>
</div>
<p>Notice that we had to use the name of the container,
<code>ecstatic_nightingale</code>, to get the logs. This is because the
<code>docker logs</code> command requires the name of the
<strong>container</strong> not the <strong>image</strong>.</p>
<p>Great, now that we have a container in the background, lets try to
register a unicorn sighting!</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-X</span> PUT localhost:8321/unicorn_spotted<span class="pp">?</span>location=moon\&amp;brightness=100</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>curl: (7) Failed to connect to localhost port 8321 after 0 ms: Couldn't connect to server</code></pre>
</div>
<p>That is right! We need to expose the port to the host machine, as we
did in Docker Desktop.</p>
</section><section><h2 class="section-heading" id="exposing-ports">Exposing ports<a class="anchor" aria-label="anchor" href="#exposing-ports"></a>
</h2>
<hr class="half-width">
<p>The container is running in its own isolated environment. To be able
to communicate with it, we need to tell Docker to expose the port to the
host machine.</p>
<p>This can be done using the <code>-p</code> flag. We also need to
specify the port to be used on the host machine and the port to expose
on the container, like so:</p>
<pre><code>-p &lt;host_port&gt;:&lt;container_port&gt;</code></pre>
<p>In this case we want to expose port 8321 on the host machine to port
8321 on the container:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-d</span> <span class="at">-p</span> 8321:8321 spuacv/spuc:latest</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>6edf9ebd404625541fdb674d1a696707bad775a0161882ef459c5cbcb151e24b</code></pre>
</div>
<p>If you now look at the container that is running, you will see that
the port is exposed:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="ex">docker</span> ps</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>CONTAINER ID   IMAGE               COMMAND                  CREATED         STATUS         PORTS                                       NAMES
6edf9ebd4046   spuacv/spuc:latest  "python /spuc/spuc.p…"   4 seconds ago   Up 3 seconds   0.0.0.0:8321-&gt;8321/tcp, :::8321-&gt;8321/tcp   unruffled_noyce</code></pre>
</div>
<div class="section level3">
<h3 id="todo-why-does-it-say-8321-8321tcp">TODO why does it say <code>:::8321-&gt;8321/tcp</code>?<a class="anchor" aria-label="anchor" href="#todo-why-does-it-say-8321-8321tcp"></a>
</h3>
<p>So we can finally try to register a unicorn sighting:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-X</span> PUT localhost:8321/unicorn_spotted<span class="pp">?</span>location=moon\&amp;brightness=100</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="op">{</span><span class="st">"message"</span><span class="op">:</span><span class="st">"Unicorn sighting recorded!"</span><span class="op">}</span></span></code></pre>
</div>
<p>And of course we can check the logs if we want to:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="ex">docker</span> logs unruffled_noyce</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[...]

::::: 2024-10-15 11:19:47.751212 Unicorn spotted at moon!! Brightness: 100 iuhc</code></pre>
</div>
<p>It can be quite inconvenient to have to find out the name of the
container every time we want to see the logs, and it is not the only
time in which we’ll need the name of the container to interact with it.
We can make our lives easier by naming the container when we run it.</p>
</div>
</section><section><h2 class="section-heading" id="setting-the-name-of-a-container">Setting the name of a container<a class="anchor" aria-label="anchor" href="#setting-the-name-of-a-container"></a>
</h2>
<hr class="half-width">
<p>We can name the container when we run it using the
<code>--name</code> flag:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-d</span> <span class="at">--name</span> spuc_container <span class="at">-p</span> 8321:8321 spuacv/spuc:latest</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>4696d5301a792451f9954ba10cc42604a904fa1a811362733050ba04270c02eb
docker: Error response from daemon: driver failed programming external
connectivity on endpoint spuc_container (67e075648d16fafdf086573169d891bee9b33bec0c1cb5535cf82c715241bb32):
 Bind for 0.0.0.0:8321 failed: port is already allocated.</code></pre>
</div>
<p>Oops! It looks like we already have a container running on port 8321.
Of course, it is the container that we ran earlier, unruffled_noyce, and
we can’t have two containers running on the same port!</p>
<p>To fix this, we can stop the container that is running on port 8321
using the <code>docker stop</code> command:</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="ex">docker</span> stop unruffled_noyce</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">unruffled_noyce</span></span></code></pre>
</div>
<p><strong>Note:</strong> Using
<code>docker kill &lt;container_name&gt;</code>, will also work,
although it is best to leave that as a last resort.</p>
<p>Right, now we can try running the container again:</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-d</span> <span class="at">--name</span> spuc_container <span class="at">-p</span> 8321:8321 spuacv/spuc:latest</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">bf9b2abc95a7c7f25dc8c1c4c334fcf4ce9642754ed7f6b5586d82f9e9e45ac7</span></span></code></pre>
</div>
<p>And now we can see the logs using the name of the container, and even
follow the logs in real time using the <code>-f</code> flag:</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="ex">docker</span> logs <span class="at">-f</span> spuc_container</span></code></pre>
</div>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>
  Logs
  </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
            \
             \
              \\
               \\\
                &gt;\/7
            _.-(º   \
           (=___._/` \            ____  ____  _    _  ____
                )  \ |\          / ___||  _ \| |  | |/ ___|
               /   / ||\         \___ \| |_) | |  | | |
              /    &gt; /\\\         ___) |  __/| |__| | |___
             j    &lt; _\           |____/|_|    \____/ \____|
         _.-' :      ``.
         \ r=._\        `.       Space Purple Unicorn Counter
        &lt;`\\_  \         .`-.
         \ r-7  `-. ._  ' .  `\
          \`,      `-.`7  7)   )
           \/         \|  \'  / `-._
                      ||    .'
                       \\  (
                        &gt;\  &gt;
                    ,.-' &gt;.'
                   &lt;.'_.''
                     &lt;'


Welcome to the Space Purple Unicorn Counter!

:::: Units set to Imperial Unicorn Hoove Candles [iuhc] ::::")

:: Try recording a unicorn sighting with:
    curl -X PUT localhost:8321/unicorn_spotted?location=moon\&amp;brightness=100
</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>This also blocks the terminal, so you will need to use
<code>[Ctrl+C]</code> to stop following the logs. There is an important
difference though. Because the container is running in the background,
using <code>[Ctrl+C]</code> will not stop the container, only the log
following.</p>
</section><section><h2 class="section-heading" id="executing-commands-in-a-running-container">Executing commands in a running container<a class="anchor" aria-label="anchor" href="#executing-commands-in-a-running-container"></a>
</h2>
<hr class="half-width">
<p>One of the very useful things we could do in docker compose was to
run commands inside a container. If you remember, we could do this using
the <code>Exec</code> tab. In the Docker CLI, we can do this using the
<code>docker exec</code> command. Lets try for example:</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="ex">docker</span> exec spuc_container cat config/print.config</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># This file configures the print output to the terminal.
# Available variables are: count, time, location, brightness, units
# The values of these variables will be replaced if wrapped in curly braces.
# Lines beginning with # are ignored.
::::: {time} Unicorn spotted at {location}!! Brightness: {brightness} {units}</code></pre>
</div>
<p>This command runs <code>cat config/print.config</code> inside the
container. This is a step forward, but it is not quite the experience we
had in Docker Desktop. There, we had a live terminal <em>inside</em> the
container, and we could run commands interactively.</p>
<p>To do that, we need to use the <code>-it</code> flag, and specify a
command that will load the terminal, i.e. <code>bash</code>. Let’s try
launching an interactive terminal session inside the container, running
the bash shell:</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="ex">docker</span> exec <span class="at">-it</span> spuc_container bash</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>root@50159dddde44:/spuc#</code></pre>
</div>
<p>This is more like it! now we can run commands as if we were inside
the container itself, as we did in Docker Desktop.</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="ex">apt</span> update</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="ex">apt</span> install tree</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a><span class="ex">tree</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[...]

.
├── __pycache__
│   └── strings.cpython-312.pyc
├── config
│   └── print.config
├── output
├── requirements.txt
├── spuc.py
└── strings.py

4 directories, 5 files</code></pre>
</div>
<p>To get out from this interactive session, we need to use
<code>[Ctrl+D]</code>, or type <code>exit</code>.</p>
<div id="interactive-sessions" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="interactive-sessions" class="callout-inner">
<h3 class="callout-title">Interactive sessions</h3>
<div class="callout-content">
<p>The <code>-it</code> flag that we just used is very useful. It
actually helps us overcome the problem we had with the
<code>alpine</code> container in the previous episode. If we were to
simply run the <code>alpine</code> container we would have the same
issue we had before. Namely, the container exits immediately and we
can’t <code>exec</code> into it. However, we can use the
<code>-it</code> flag on the <code>run</code> command, and get an
interactive terminal session inside the container:</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-it</span> alpine:latest</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Unable to find image 'alpine:latest' locally
latest: Pulling from library/alpine
43c4264eed91: Pull complete
Digest: sha256:beefdbd8a1da6d2915566fde36db9db0b524eb737fc57cd1367effd16dc0d06d
Status: Downloaded newer image for alpine:latest
/ #</code></pre>
</div>
<p>We are inside the container, and it stayed alive because we are
running an interactive session. We can play inside as much as we want,
and when we are done, we can simply type <code>exit</code> to leave the
container. As opposed to the <code>spuc</code> container, which was
running a service and we exec’ed into, this container will be terminated
on exit.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="reviving-containers">Reviving Containers<a class="anchor" aria-label="anchor" href="#reviving-containers"></a>
</h2>
<hr class="half-width">
<p>Another thing Docker Desktop allowed us to do was to wake up a
previously stopped container. We can of course do the same thing in the
Docker CLI.</p>
<p>To show this, lets first stop the container we have running:</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="ex">docker</span> stop spuc_container</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">spuc_container</span></span></code></pre>
</div>
<p>To <em>revive</em> the container, we can use the
<code>docker start</code> command:</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="ex">docker</span> start spuc_container</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">spuc_container</span></span></code></pre>
</div>
<p>We could now check that the container is running again using the
<code>docker ps</code> command. However, lets try another useful
command:</p>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="ex">docker</span> stats</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>CONTAINER ID   NAME              CPU %     MEM USAGE / LIMIT     MEM %     NET I/O           BLOCK I/O        PIDS
bf9b2abc95a7   spuc_container    0.01%     23.61MiB / 15.29GiB   0.15%     23.6kB / 589B     5.1MB / 201kB    5</code></pre>
</div>
<p>This command lets us see the live resource usage of containers,
similar to the task manager on Windows or top on Linux. We can exit the
stats with <code>[Ctrl+C]</code>.</p>
<p>As we can see, the container is alive and well, and we can now exec
into it again if we want to.</p>
</section><section><h2 class="section-heading" id="cleaning-up">Cleaning up<a class="anchor" aria-label="anchor" href="#cleaning-up"></a>
</h2>
<hr class="half-width">
<p>The last thing we need to know is how to clean up after ourselves. We
can do this using the <code>docker rm</code> command to remove a
container, and the <code>docker image rm</code> command to remove an
image:</p>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="ex">docker</span> stop spuc_container</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">spuc_container</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="ex">docker</span> rm spuc_container</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">spuc_container</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="ex">docker</span> image rm spuacv/spuc:latest</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Untagged: spuacv/spuc:latest
Untagged: spuacv/spuc@sha256:ad219064aaaad76860c53ec8420730d69dc5f8beb9345b0a15176111c2a976c5
Deleted: sha256:ce72bd42e51c049fe29b4c15dc912e88c4461e94c2e1d403b90e2e53dfb1b420
Deleted: sha256:975e4f6d3de315ced48fa0d0eda7e3af5cd4953c16adfbd443e65d6d2bf0eaa6
Deleted: sha256:f3fc2c0e51d4240d55e40b0305762df66600cdd5073a5c92008cfe8f867f5437
Deleted: sha256:f3e2fffff5c16237e6507a6196eb76fd2eba64e343c3a1b2692b73b95fcd1298
Deleted: sha256:d4d3e0d103c04b9fd2eb428699c46302a3d38d695729ee49068be07ad7e5c442
Deleted: sha256:700c7bb1865e2ca492d821c689f11175c66e9d27f210b3f04521040290c34126
Deleted: sha256:5d5adb77457c9a495a5037ce44a0db461b8d3b605177a2c3bc6dc0d7876a681d
Deleted: sha256:3a77b40519ce3ffa585333bab02f30371b4c8c7ffa10a35fd4c82a0d3423fa91
Deleted: sha256:791eb7562f83ac1fc48aa6f31129bf947d7de7d8c9b85db92131c3beb5650bd6
Deleted: sha256:c59180f9a5f41ea7e3d92ee36d5b4c01dadf5148075c0d01c394f7efc321a3ca
Deleted: sha256:8d853c8add5d1e7b0aafc4b68a3d9fb8e7a0da27970c2acf831fe63be4a0cd2c</code></pre>
</div>
<p>An alternative is to do a single-line full clean up. We can also
remove all stopped containers and unused images using the
<code>docker system prune</code> command:</p>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="ex">docker</span> system prune</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>WARNING! This will remove:
  - all stopped containers
  - all networks not used by at least one container
  - all dangling images
  - unused build cache

Are you sure you want to continue? [y/N] y
Deleted Containers:
90d006980a999176dd82e95119556cdf62431c26147bdbd3513e1733be1a5897

Deleted Images:
untagged: ghcr.io/uomresearchit/spuc@sha256:bc43ebfe7dbdbac5bc0b4d849dd2654206f4e4ed1fb87c827b91be56ce107f2e
deleted: sha256:f03fb04b8bc613f46cc1d1915d2f98dcb6e008ae8e212ae9a3dbfaa68c111476

Total reclaimed space: 13.09MB</code></pre>
</div>
<div class="section level3">
<h3 id="automatic-cleanup">Automatic cleanup<a class="anchor" aria-label="anchor" href="#automatic-cleanup"></a>
</h3>
<p>There is one more point to make. It is nice not to have to clean up
containers manually all the time. Luckily, the Docker CLI has a flag
that will remove the container when it is stopped: <code>--rm</code>.
This can be very useful, especially when you are naming containers, as
it prevents name conflicts.</p>
<p>Lets try it:</p>
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-d</span> <span class="at">--rm</span> <span class="at">--name</span> spuc_container <span class="at">-p</span> 8321:8321 spuacv/spuc:latest</span></code></pre>
</div>
<p>We can verify that the container exists using <code>docker ps</code>.
When the container is stopped, however, the container is automatically
removed. We don’t have to worry about cleaning up afterwards, but it
comes at a price. Since we’ve deleted the container, there is no way to
bring it back.</p>
<p>We will use the command going forward, as it is a good practice to
keep your system clean and tidy.</p>
<p><br></p>
<p>The last command we ran is a relatively standard command in the
Docker CLI. If you are thinking “wow, that command is getting pretty
long…”, you are right! Things will get even worse before they get
better, but we will cover how to manage this later in the course.</p>
<p>We are now equipped with everything we saw we could do in Docker
Desktop, but with steroids. There are many more things we can do with
the Docker CLI, including data persistance. We will cover these in the
next episode.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>All the commands are structured with a main command, a specialising
command, an action command, and the name of the object to act on.</li>
<li>Everything we did in Docker Desktop (and more!) can be done in the
Docker CLI with:</li>
</ul>
<table class="table">
<colgroup>
<col width="40%">
<col width="59%">
</colgroup>
<thead><tr class="header">
<th>Command</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Images</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>docker pull &lt;image&gt;</code></td>
<td>Pull an image from a registry</td>
</tr>
<tr class="odd">
<td><code>docker image ls</code></td>
<td>List all images on the system</td>
</tr>
<tr class="even">
<td><code>docker inspect &lt;image&gt;</code></td>
<td>Show detailed information about an image</td>
</tr>
<tr class="odd">
<td><code>docker run &lt;image&gt;</code></td>
<td>Run a container from an image</td>
</tr>
<tr class="even">
<td><code>docker image rm &lt;image&gt;</code></td>
<td>Remove an image</td>
</tr>
<tr class="odd">
<td><strong>Containers</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>docker logs &lt;container&gt;</code></td>
<td>Show the logs of a container</td>
</tr>
<tr class="odd">
<td><code>docker exec &lt;container&gt; &lt;cmd&gt;</code></td>
<td>Run a command in a running container</td>
</tr>
<tr class="even">
<td><code>docker stop &lt;container&gt;</code></td>
<td>Stop a running container</td>
</tr>
<tr class="odd">
<td><code>docker start &lt;container&gt;</code></td>
<td>Start a stopped container</td>
</tr>
<tr class="even">
<td><code>docker rm &lt;container&gt;</code></td>
<td>Remove a container</td>
</tr>
<tr class="odd">
<td><strong>System</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>docker ps</code></td>
<td>List all running containers</td>
</tr>
<tr class="odd">
<td><code>docker stats</code></td>
<td>Show live resource usage of containers</td>
</tr>
<tr class="even">
<td><code>docker system prune</code></td>
<td>Remove all stopped containers and unused images</td>
</tr>
</tbody>
</table>
<table class="table">
<colgroup>
<col width="12%">
<col width="19%">
<col width="67%">
</colgroup>
<thead><tr class="header">
<th>Flag</th>
<th>Used on</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>-f</code></td>
<td><code>inspect</code></td>
<td>Specify the output format</td>
</tr>
<tr class="even">
<td><code>-f</code></td>
<td><code>logs</code></td>
<td>Follow the logs in real time</td>
</tr>
<tr class="odd">
<td><code>-a</code></td>
<td><code>ps</code></td>
<td>List all containers, including stopped ones</td>
</tr>
<tr class="even">
<td><code>-it</code></td>
<td>
<code>run</code>, <code>exec</code>
</td>
<td>Interactively run a command in a running container</td>
</tr>
<tr class="odd">
<td><code>-d</code></td>
<td><code>run</code></td>
<td>Run a container in the background</td>
</tr>
<tr class="even">
<td><code>-p</code></td>
<td><code>run</code></td>
<td>Expose a port from the container to the host</td>
</tr>
<tr class="odd">
<td><code>--name</code></td>
<td><code>run</code></td>
<td>Name a container</td>
</tr>
<tr class="even">
<td><code>--rm</code></td>
<td><code>run</code></td>
<td>Remove the container when it is stopped</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</section></section><section id="aio-docker-cli-advanced"><p>Content from <a href="docker-cli-advanced.html">Using the full power of the Docker CLI</a></p>
<hr>
<p>Last updated on 2024-10-15 |

        <a href="https://github.com/UoMResearchIT/docker-introduction/edit/main/episodes/docker-cli-advanced.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>Now that we have learned the basics of the Docker CLI, getting set up
with all the tools we came across in Docker Desktop, we can start to
explore the full power of Docker!</p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What actually happens when I run a container?</li>
<li>How can I control the behaviour of containers?</li>
<li>How do I get data in and out of containers?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn the lifecycle of Docker containers</li>
<li>Learn about Entrypoints and Commands and how to manipulate them</li>
<li>Learn how to use files with container using mounts and volumes</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="data-in-containers">Data in containers<a class="anchor" aria-label="anchor" href="#data-in-containers"></a>
</h1>
<p>In the earlier section on Docker Desktop, we learned how to interact
with containers and used this to have a look at the
unicorn_sightings.txt file.</p>
<p>It is quite annoying that the file does not persist between runs of
the container! Also, with the file being in the container, we can’t
(easily) do much with it.</p>
<p>This is where the Docker CLI starts to shine.</p>
<div class="section level2">
<h2 id="making-our-data-persist">Making our data persist<a class="anchor" aria-label="anchor" href="#making-our-data-persist"></a>
</h2>
<p>Docker containers are naturally isolated from the host system,
meaning that they have their own filesystems and cannot access the host
filesystem.</p>
<p>They are also ephemeral, meaning that they are designed to be
temporary and are destroyed when they are stopped.</p>
<p>This is mostly a good thing, as it means that containers are
lightweight and can be easily recreated, but we can’t be throwing our
unicorn sightings away like this!</p>
<p>Luckily, Docker has methods for allowing containers to persist
data.</p>
<div class="section level3">
<h3 id="volumes">Volumes<a class="anchor" aria-label="anchor" href="#volumes"></a>
</h3>
<p>The first way to allow a container to access the host filesystem is
by using a <code>volume</code>. A volume is a specially designated
directory on the host filesystem which is shared with the container,
hidden away deep in the host filesystem.</p>
<p>Volumes are very tightly controlled by Docker, and are designed to be
used for sharing data between containers, or for persisting data between
runs of a container. They are very useful, but can be a bit tricky to
use.</p>
<p>Let’s have a look at how we can use a volume to persist the
<code>unicorn_sightings.txt</code> file between runs of the
container.</p>
<p>We do this by modifying our <code>docker run</code> command to
include a <code>-v</code> (for volume) flag, a volume name and a path
inside the container.</p>
<p><strong>Note</strong>: You have to be <em>really</em> careful with
the syntax for this command. See the challenge box below for common
mistakes (and their resolution).</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> docker run <span class="at">-d</span> <span class="at">--rm</span> <span class="at">--name</span> spuc_container <span class="at">-p</span> 8321:8321 <span class="at">-v</span> spuc-volume:/output ghcr.io/uomresearchit/spuc:latest</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">f1bd2bb9062348b6a1815f5076fcd1b79e603020c2d58436408c6c60da7e73d2</span></span></code></pre>
</div>
<p>Ok! But what is happening?</p>
<p>We can see what containers we have created using:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">$</span> docker volume ls</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>local     spuc-volume</code></pre>
</div>
<p>And we can see information about the volume using:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">$</span> docker volume inspect spuc-volume</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[
    {
        "CreatedAt": "2024-10-11T11:15:09+01:00",
        "Driver": "local",
        "Labels": null,
        "Mountpoint": "/var/lib/docker/volumes/spuc-volume/_data",
        "Name": "spuc-volume",
        "Options": null,
        "Scope": "local"
    }
]</code></pre>
</div>
<p>Which shows us that the volume is stored in
<code>/var/lib/docker/volumes/spuc-volume/_data</code> on the host
filesystem. Which you can visit if you have superuser permissions
(sudo).</p>
<p>But what about the container? Has this actually worked? Let’s record
some sightings and see if they persist between runs.</p>
<p>First, what’s that over there?? A unicorn! No… three unicorns! Let’s
record these sightings.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">$</span> curl <span class="at">-X</span> PUT localhost:8321/unicorn_spotted<span class="pp">?</span>location=moon\&amp;brightness=100</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="ex">$</span> curl <span class="at">-X</span> PUT localhost:8321/unicorn_spotted<span class="pp">?</span>location=earth\&amp;brightness=10</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="ex">$</span> curl <span class="at">-X</span> PUT localhost:8321/unicorn_spotted<span class="pp">?</span>location=mars\&amp;brightness=400</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="op">{</span><span class="st">"message"</span><span class="op">:</span><span class="st">"Unicorn sighting recorded!"</span><span class="op">}</span></span>
<span><span class="op">{</span><span class="st">"message"</span><span class="op">:</span><span class="st">"Unicorn sighting recorded!"</span><span class="op">}</span></span>
<span><span class="op">{</span><span class="st">"message"</span><span class="op">:</span><span class="st">"Unicorn sighting recorded!"</span><span class="op">}</span></span></code></pre>
</div>
<p>Ok, let’s check the sightings file.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">$</span> docker exec spuc_container cat /code/output/unicorn_sightings.txt</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>time,brightness,unit
2024-10-11 10:30:18.927696,100,iuhc
2024-10-11 10:30:25.744330,10,iuhc
2024-10-11 10:30:30.005247,400,iuhc</code></pre>
</div>
<p>Now for our test, we will stop the container, run it again and check
the sightings file.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">$</span> docker stop spuc_container</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="ex">$</span> docker run <span class="at">-d</span> <span class="at">--rm</span> <span class="at">--name</span> spuc_container <span class="at">-p</span> 8321:8321 <span class="at">-v</span> spuc-volume:/code/output ghcr.io/uomresearchit/spuc:latest</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="ex">$</span> docker exec spuc_container cat /code/output/unicorn_sightings.txt</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>time,brightness,unit
2024-10-11 10:30:18.927696,100,iuhc
2024-10-11 10:30:25.744330,10,iuhc
2024-10-11 10:30:30.005247,400,iuh</code></pre>
</div>
<p>So there we have it! The sightings persist between runs of the
container. This is a great way to keep data between runs of a container,
but watch out for the syntax!</p>
<div id="common-mistakes-with-volumes" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="common-mistakes-with-volumes" class="callout-inner">
<h3 class="callout-title">Common mistakes with volumes</h3>
<div class="callout-content">
<p>Given you are in a directory containing a directory named
<code>spuc</code>, what will happen when you run the following
commands?</p>
<ol style="list-style-type: upper-alpha">
<li><p>$ docker run -v ./spuc-volume:/foo spuc:latest</p></li>
<li><p>$ docker run -v spuc-volume:/foo spuc:latest</p></li>
<li><p>$ docker run -v ./spuc:/foo spuc:latest</p></li>
<li><p>$ docker run -v ${PWD}/spuc:/foo spuc:latest</p></li>
<li><p>$ docker run -v ${PWD}/spucs:/foo spuc:latest</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ol style="list-style-type: upper-alpha">
<li>The path to the volume must be an absolute path, not a relative
path. You can use the $PWD environment variable to get the current
working directory. This will create a (root owned) directory in the
current working directory, which is not what you want. Use “sudo rm -rf
./spuc-volume” to remove the volume and try again.</li>
<li>This is the correct syntax for creating a volume. This will create a
volume called spuc-volume and mount it to the /foo directory in the
container.</li>
<li>Because ./spuc is not an absolute path, this will create a new
volume called spuc and mount it to the /foo directory in the container.
This is not what you want. Use “sudo rm -rf ./spuc” to remove the volume
and try again.</li>
<li>This is valid syntax but not for creating a volume! This will create
a bind mount instead. More on these next.</li>
<li>This will create a new volume called spuc<strong>s</strong> and
mount it to the /foo directory in the container. This is not what you
want. Use “sudo rm -rf ./spucs” to remove the volume and try again.</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="bind-mounting-directories">Bind mounting directories<a class="anchor" aria-label="anchor" href="#bind-mounting-directories"></a>
</h3>
<p>The second way to allow a container to access the host filesystem is
by using a <code>bind mount</code>. A bind mount is a direct mapping of
a directory on the host filesystem to a directory in the container
filesystem.</p>
<p>This can be appealing, as it allows you to directly access files on
the host filesystem from the container, but it has its own
challenges.</p>
<p>Let’s have a look at how we can use a bind mount to persist the
<code>unicorn_sightings.txt</code> file between runs of the
container.</p>
<p>Confusingly, bind mounting is also done using the <code>-v</code>
flag, but with a different syntax. We specify an
<strong>absolute</strong> path to the directory on the host filesystem,
followed by a colon, followed by the path to the directory in the
container filesystem.</p>
<p>It can be annoying to type the full path to a directory, so we can
use the <code>$PWD</code> environment variable to get the current
working directory.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">$</span> docker stop spuc_container </span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="ex">$</span> docker run <span class="at">-d</span> <span class="at">--rm</span> <span class="at">--name</span> spuc_container <span class="at">-p</span> 8321:8321 <span class="at">-v</span> <span class="va">$PWD</span>/spuc:/code/output ghcr.io/uomresearchit/spuc:latest</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="ex">$</span> curl <span class="at">-X</span> PUT localhost:8321/unicorn_spotted<span class="pp">?</span>location=mars\&amp;brightness=400</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="ex">$</span> tree spuc/</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>spuc/
└── unicorn_sightings.txt</code></pre>
</div>
<p>So now we can access the /code/output directory in the container on
the host filesystem. This is totally functional way to persist data
between runs of a container but there are downsides.</p>
<p>To illusrate this, let’s see what the permissions are on the file we
just created.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">$</span> ls <span class="at">-l</span> spuc/unicorn_sightings.txt</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>-rw-r--r-- 1 root root 57 Oct 11 14:14 spuc/unicorn_sightings.txt</code></pre>
</div>
<p>Argh, the file is owned by root!</p>
<p>This is because the container runs as root, and so any files created
by the container are owned by root. This can be a problem, as you will
not have permission to access the file without using
<code>sudo</code>.</p>
<p>This is a common problem with bind mounts, and can be a bit of a pain
to deal with. You can change the ownership of the file using
<code>sudo chown</code>, but this can be a bit of a hassle.</p>
<p>Additionally, it is hard for Docker to clean up bind mounts, as they
are not managed by Docker. The management of bind mounts is left to the
user.</p>
<p>Really, neither volumes nor bind mounts are perfect, but they are
both useful tools for persisting data between runs of a container and
have both allowed us to keep the unicorn_sightings.txt file between runs
of the container.</p>
<p>Later in these lessons we will see some more ergonomic ways to work
with volumes and bind mounts.</p>
</div>
</div>
<div class="section level2">
<h2 id="sharing-files-with-containers">Sharing files with containers<a class="anchor" aria-label="anchor" href="#sharing-files-with-containers"></a>
</h2>
<p>Earlier, we looked at how to change the config file in SPUC to enable
exporting. This was a bit of a hassle, as we had to use the Docker
Desktop interface to do this and it did not persist between runs of the
container.</p>
<p>We now have the tools to address this! We can use a bind mount to
share the config file with the container.</p>
<p>Let’s have a look at how we can do this. First we need to make the
config file itself.</p>
<p>The SPUC README on dockerhub tells us that the config file should be
in the following format:</p>
<pre class="plaintext"><code>::::: {time} Unicorn spotted at {location}!! Brightness: {brightness} {units}</code></pre>
<p>And should be present at <code>/code/config/print.config</code>.</p>
<p>Let’s get to it then. First we need to make the file (on the
host).</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"::::: {time} Unicorn spotted at {location}!! Brightness: {brightness} {units}"</span> <span class="op">&gt;</span> print.config</span></code></pre>
</div>
<p>Now we can bind mount this file to the container. Again we will use
<code>-v</code> and the <code>$PWD</code> environment variable to get
the current working directory. This time, however, we will specify a
specific file to mount, not a directory.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="ex">$</span> docker stop spuc_container</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="ex">$</span> docker run <span class="at">-d</span> <span class="at">--rm</span> <span class="at">--name</span> spuc_container <span class="at">-p</span> 8321:8321 <span class="at">-v</span> <span class="va">$PWD</span>/print.config:/code/config/print.config <span class="at">-v</span> spuc-volume:/code/output ghcr.io/uomresearchit/spuc:latest</span></code></pre>
</div>
<p>Now if we check the logs of the container, we can see that the config
file has been loaded correctly and that the print format has been
changed.</p>
<p>First, let’s record another sighting, then check the logs.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="ex">$</span> curl <span class="at">-X</span> PUT localhost:8321/unicorn_spotted<span class="pp">?</span>location=moon\&amp;brightness=100</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="ex">$</span> docker logs spuc_container</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[...]
[...]
::::: (2024-10-11 14:29:07.548965) Unicorn spotted at moon!! Brightness: 100 iuhc</code></pre>
</div>
<p>Fantastic! We have now managed to share a file with the container,
and have changed the behaviour of the container using this file.</p>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>We have learned about volumes and bind mounts, two ways to allow a
container to access the host filesystem. We have used these to persist
data between runs of a container and to share files with a
container.</p>
<p>They can both be a bit tricky to use, but are very useful tools for
working with containers and have helped us get SPUC working much more
like we want it to.</p>
</div>
</div>
<div class="section level2">
<h2 id="setting-the-environment">Setting the environment<a class="anchor" aria-label="anchor" href="#setting-the-environment"></a>
</h2>
<p>One other interesting reading from the SPUC README is the presence of
an environment variable, <code>EXPORT</code> which can be set to
<code>True</code> to enable an API endpoint for exporting the unicorn
sightings.</p>
<p>This sounds like a useful feature, but how can we set an environment
variable in a container?</p>
<p>Thankfully this is quite straightforward, we can use the
<code>-e</code> flag to set an environment variable in a container.</p>
<p>Modifying our run command again:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="ex">$</span> docker stop spuc_container</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="ex">$</span> docker run <span class="at">-d</span> <span class="at">--rm</span> <span class="at">--name</span> spuc_container <span class="at">-p</span> 8321:8321 <span class="at">-v</span> <span class="va">$PWD</span>/print.config:/code/config/print.config <span class="at">-v</span> spuc-volume:/code/output <span class="at">-e</span> EXPORT=true ghcr.io/uomresearchit/spuc:latest</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="ex">$</span> docker logs spuc_container</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[...]
::::: Initializing SPUC...
::::: Units set to Imperial Unicorn Hoove Candles [iuhc].

Welcome to the Space Purple Unicorn Counter!
::::: Try 'curl -X PUT localhost:8321/unicorn_spotted?location=moon\&amp;brightness=100' to record a unicorn sighting!
::::: Or 'curl localhost:8321/export' to download the unicorn sightings file!</code></pre>
</div>
<p>And now we can see that the export endpoint is available!</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="ex">$</span> curl localhost:8321/export</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>time,brightness,unit
2024-10-11 14:43:42.060883,100,iuhc
2024-10-11 14:43:48.064323,400,iuhc
2024-10-11 14:43:49.972220,10,iuhc</code></pre>
</div>
<p>This is great! No need to bind mount or exec to get the data out of
the container, we can just use the API endpoint.</p>
<p>Defaulting to network style connections is very common in Docker
containers and saves a lot of hassle.</p>
<p>Environment variables are a very common tool for configuring
containers. They are used to set things like API keys, database
connection strings, and other configuration options.</p>
</div>
<div class="section level2">
<h2 id="passing-parameters">Passing parameters<a class="anchor" aria-label="anchor" href="#passing-parameters"></a>
</h2>
<p>Finally, we must address a very serious shortcoming of the SPUC
container. It is recording the brightness of the unicorns in Imperial
Unicorn Hoove Candles (iuhc)! This is a very outdated unit and we
<strong>must</strong> change it to metric.</p>
<p>Fortunately the SPUC README tells us that we can pass a parameter to
the container to set the units to metric. This is done by passing a
parameter to the container when it is run, overriding the default
command.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="ex">$</span> docker stop spuc_container</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="ex">$</span> docker run <span class="at">-d</span> <span class="at">--rm</span> <span class="at">--name</span> spuc_container <span class="at">-p</span> 8321:8321 <span class="at">-v</span> <span class="va">$PWD</span>/print.config:/code/config/print.config <span class="at">-v</span> spuc-volume:/code/output <span class="at">-e</span> EXPORT=true ghcr.io/uomresearchit/spuc:latest <span class="at">--units</span> iulu</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="ex">$</span> curl <span class="at">-X</span> PUT localhost:8321/unicorn_spotted<span class="pp">?</span>location=earth\&amp;brightness=10</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="ex">$</span> curl localhost:8321/export/</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>time,brightness,unit
2024-10-11 14:43:42.060883,100,iuhc
2024-10-11 14:43:48.064323,400,iuhc
2024-10-11 14:43:49.972220,10,iuhc
2024-10-11 15:30:27.823367,10,iulu</code></pre>
</div>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>You can also override the entrypoint of a container using the
<code>--entrypoint</code> flag. This is useful if you want to run a
different command in the container, or if you want to run the container
interactively.</p>
<p>You may recall:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="ex">docker</span> inspect ghcr.io/uomresearchit/spuc:latest <span class="at">-f</span> <span class="st">"Entrypoint: {{.Config.Entrypoint}} Command: {{.Config.Cmd}}"</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="ex">Entrypoint:</span> [python /code/spuc.py] Command: [--units iuhc]</span></code></pre>
</div>
<p>That SPUC has an entrypoint of <code>python /code/spuc.py</code>
making it hard to interact with. We can override this using the
<code>--entrypoint</code> flag.</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="ex">$</span> docker run <span class="at">-it</span> <span class="at">--rm</span> <span class="at">--entrypoint</span> /bin/sh ghcr.io/uomresearchit/spuc:latest</span></code></pre>
</div>
<div id="discussion2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Which of these are valid entrypoint and command combinations for the
SPUC container? What are the advantages and disadvantages of each?</p>
<table class="table">
<thead><tr class="header">
<th></th>
<th>Entrypoint</th>
<th>Command</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>A</td>
<td><code>python /code/spuc.py --units iuhc</code></td>
<td></td>
</tr>
<tr class="even">
<td>B</td>
<td><code>python /code/spuc.py</code></td>
<td><code>--units iuhc</code></td>
</tr>
<tr class="odd">
<td>C</td>
<td><code>python</code></td>
<td><code>/code/spuc.py --units iuhc</code></td>
</tr>
<tr class="even">
<td>D</td>
<td></td>
<td><code>python /code/spuc.py --units iuhc</code></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>These are all valid combinations! The best choice depends on the use
case.</p>
<ol style="list-style-type: upper-alpha">
<li><p>This combination bakes the command and the parameters into the
image. This is useful if the command is always the same and the
specified parameters are unlikely to change (although more may be
appended).</p></li>
<li><p>This combination allows the command’s arguments to be changd
easily while baking in which Python script to run.</p></li>
<li><p>This combination allows the Python script to be changed easily,
which is more likely to be bad than good!</p></li>
<li><p>This combination allows maximum flexibility, but it requires the
user to know the correct command to run.</p></li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="summary-1">Summary<a class="anchor" aria-label="anchor" href="#summary-1"></a>
</h2>
<p>In this section, we have learned about volumes and bind mounts, two
ways to allow a container to access the host filesystem. We have used
these to persist data between runs of a container and to share files
with a container.</p>
<p>We have learned how to set environment variables and pass parameters
to containers, two ways to configure the behaviour of a container.</p>
<p>SPUC is now running with the correct units and we can export the
unicorn sightings using the API endpoint! And we are no longer losing
our unicorn sightings between runs of the container.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Volumes and bind mounts are two ways to allow a container to access
the host filesystem.</li>
<li>Environment variables and parameters can be used to configure the
behaviour of a container.</li>
</ul>
</div>
</div>
</div>
</div>
</div></section><section id="aio-creating-container-images"><p>Content from <a href="creating-container-images.html">Creating Your Own Container Images</a></p>
<hr>
<p>Last updated on 2024-10-15 |

        <a href="https://github.com/UoMResearchIT/docker-introduction/edit/main/episodes/creating-container-images.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>There are lots of reasons why you might want to create your
<strong>own</strong> Docker container image.</p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I make my own Docker container images?</li>
<li>How do I document the ‘recipe’ for a Docker container image?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain the purpose of a <code>Dockerfile</code> and show some
simple examples.</li>
<li>Demonstrate how to build a Docker container image from a
<code>Dockerfile</code>.</li>
<li>Compare the steps of creating a container image interactively versus
a <code>Dockerfile</code>.</li>
<li>Create an installation strategy for a container image.</li>
<li>Demonstrate how to upload (‘push’) your container images to the
Docker Hub.</li>
<li>Describe the significance of the Docker Hub naming scheme.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>You can’t find a container image with all the tools you need on
Docker Hub.</li>
<li>You want to have a container image to “archive” all the specific
software versions you ran for a project.</li>
<li>You want to share your workflow with someone else.</li>
</ul>
<section><h2 class="section-heading" id="interactive-installation">Interactive installation<a class="anchor" aria-label="anchor" href="#interactive-installation"></a>
</h2>
<hr class="half-width">
<p>Before creating a reproducible installation, let’s experiment with
installing software inside a container. Start a container from the
<code>alpine</code> container image we used before, interactively:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> docker container run <span class="at">-it</span> alpine sh</span></code></pre>
</div>
<p>Because this is a basic container, there’s a lot of things not
installed – for example, <code>python3</code>.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">/#</span> python3</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>sh: python3: not found</code></pre>
</div>
<p>Inside the container, we can run commands to install Python 3. The
Alpine version of Linux has a installation tool called <code>apk</code>
that we can use to install Python 3.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">/#</span> apk add <span class="at">--update</span> python3 py3-pip python3-dev</span></code></pre>
</div>
<p>We can test our installation by running a Python command:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">/#</span> python3 <span class="at">--version</span></span></code></pre>
</div>
<p>Once Python is installed, we can add Python packages using the pip
package installer:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">/#</span> pip install cython</span></code></pre>
</div>
<div id="exercise-searching-for-help" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-searching-for-help" class="callout-inner">
<h3 class="callout-title">Exercise: Searching for Help</h3>
<div class="callout-content">
<p>Can you find instructions for installing R on Alpine Linux? Do they
work?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>A quick search should hopefully show that the way to install R on
Alpine Linux is:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">/#</span> apk add R</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Once we exit, these changes are not saved to a new container image by
default. There is a command that will “snapshot” our changes, but
building container images this way is not easily reproducible. Instead,
we’re going to take what we’ve learned from this interactive
installation and create our container image from a reproducible recipe,
known as a <code>Dockerfile</code>.</p>
<p>If you haven’t already, exit out of the interactively running
container.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">/#</span> exit</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="put-installation-instructions-in-a-dockerfile">Put installation instructions in a <code>Dockerfile</code>
<a class="anchor" aria-label="anchor" href="#put-installation-instructions-in-a-dockerfile"></a>
</h2>
<hr class="half-width">
<p>A <code>Dockerfile</code> is a plain text file with keywords and
commands that can be used to create a new container image.</p>
<p>From your shell, go to the folder you downloaded at the start of the
lesson and print out the Dockerfile inside:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">$</span> cd ~/Desktop/docker-intro/basic</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="ex">$</span> cat Dockerfile</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>FROM &lt;EXISTING IMAGE&gt;
RUN &lt;INSTALL CMDS FROM SHELL&gt;
RUN &lt;INSTALL CMDS FROM SHELL&gt;
CMD &lt;CMD TO RUN BY DEFAULT&gt;</code></pre>
</div>
<p>Let’s break this file down:</p>
<ul>
<li>The first line, <code>FROM</code>, indicates which container image
we’re starting with. It is the “base” container image we are going to
start from.</li>
<li>The next two lines <code>RUN</code>, will indicate installation
commands we want to run. These are the same commands that we used
interactively above.</li>
<li>The last line, <code>CMD</code>, indicates the default command we
want a container based on this container image to run, if no other
command is provided. It is recommended to provide <code>CMD</code> in
<em>exec-form</em> (see the <a href="https://docs.docker.com/engine/reference/builder/#cmd" class="external-link"><code>CMD</code>
section</a> of the Dockerfile documentation for more details). It is
written as a list which contains the executable to run as its first
element, optionally followed by any arguments as subsequent elements.
The list is enclosed in square brackets (<code>[]</code>) and its
elements are double-quoted (<code>"</code>) strings which are separated
by commas. For example,
<code>CMD ["ls", "-lF", "--color", "/etc"]</code> would translate to
<code>ls -lF --color /etc</code>.</li>
</ul>
<div id="shell-form-and-exec-form-for-cmd" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="shell-form-and-exec-form-for-cmd" class="callout-inner">
<h3 class="callout-title">
<em>shell-form</em> and <em>exec-form</em> for
CMD</h3>
<div class="callout-content">
<p>Another way to specify the parameter for the <a href="https://docs.docker.com/engine/reference/builder/#cmd" class="external-link"><code>CMD</code>
instruction</a> is the <em>shell-form</em>. Here you type the command as
you would call it from the command line. Docker then silently runs this
command in the image’s standard shell. <code>CMD cat /etc/passwd</code>
is equivalent to <code>CMD ["/bin/sh", "-c", "cat /etc/passwd"]</code>.
We recommend to prefer the more explicit <em>exec-form</em> because we
will be able to create more flexible container image command options and
make sure complex commands are unambiguous in this format.</p>
</div>
</div>
</div>
<div id="exercise-take-a-guess" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-take-a-guess" class="callout-inner">
<h3 class="callout-title">Exercise: Take a Guess</h3>
<div class="callout-content">
<p>Do you have any ideas about what we should use to fill in the sample
Dockerfile to replicate the installation we did above?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Solution: </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Based on our experience above, edit the <code>Dockerfile</code> (in
your text editor of choice) to look like this:</p>
<pre><code>FROM alpine
RUN apk add --update python3 py3-pip python3-dev
RUN pip install cython
CMD ["python3", "--version"]</code></pre>
</div>
</div>
</div>
</div>
<p>The recipe provided by the <code>Dockerfile</code> shown in the
solution to the preceding exercise will use Alpine Linux as the base
container image, add Python 3 and the Cython library, and set a default
command to request Python 3 to report its version information.</p>
</section><section><h2 class="section-heading" id="create-a-new-docker-image">Create a new Docker image<a class="anchor" aria-label="anchor" href="#create-a-new-docker-image"></a>
</h2>
<hr class="half-width">
<p>So far, we only have a text file named <code>Dockerfile</code> – we
do not yet have a container image. We want Docker to take this
<code>Dockerfile</code>, run the installation commands contained within
it, and then save the resulting container as a new container image. To
do this we will use the <code>docker image build</code> command.</p>
<p>We have to provide <code>docker image build</code> with two pieces of
information:</p>
<ul>
<li>the location of the <code>Dockerfile</code>
</li>
<li>the name of the new container image. Remember the naming scheme from
before? You should name your new image with your Docker Hub username and
a name for the container image, like this:
<code>USERNAME/CONTAINER_IMAGE_NAME</code>.</li>
</ul>
<p>All together, the build command that you should run on your computer,
will have a similar structure to this:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">$</span> docker image build <span class="at">-t</span> USERNAME/CONTAINER_IMAGE_NAME .</span></code></pre>
</div>
<p>The <code>-t</code> option names the container image; the final dot
indicates that the <code>Dockerfile</code> is in our current
directory.</p>
<p>For example, if my user name was <code>alice</code> and I wanted to
call my container image <code>alpine-python</code>, I would use this
command:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">$</span> docker image build <span class="at">-t</span> alice/alpine-python .</span></code></pre>
</div>
<div id="build-context" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="build-context" class="callout-inner">
<h3 class="callout-title">Build Context</h3>
<div class="callout-content">
<p>Notice that the final input to <code>docker image build</code> isn’t
the Dockerfile – it’s a directory! In the command above, we’ve used the
current working directory (<code>.</code>) of the shell as the final
input to the <code>docker image build</code> command. This option
provides what is called the <em>build context</em> to Docker – if there
are files being copied into the built container image <a href="/advanced-containers">more details in the next episode</a> they’re
assumed to be in this location. Docker expects to see a Dockerfile in
the build context also (unless you tell it to look elsewhere).</p>
<p>Even if it won’t need all of the files in the build context
directory, Docker does “load” them before starting to build, which means
that it’s a good idea to have only what you need for the container image
in a build context directory, as we’ve done in this example.</p>
</div>
</div>
</div>
<div id="exercise-review" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-review" class="callout-inner">
<h3 class="callout-title">Exercise: Review!</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Think back to earlier. What command can you run to check if your
container image was created successfully? (Hint: what command shows the
container images on your computer?)</p></li>
<li><p>We didn’t specify a tag for our container image name. What tag
did Docker automatically use?</p></li>
<li><p>What command will run a container based on the container image
you’ve created? What should happen by default if you run such a
container? Can you make it do something different, like print “hello
world”?</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li><p>To see your new image, run <code>docker image ls</code>. You
should see the name of your new container image under the “REPOSITORY”
heading.</p></li>
<li><p>In the output of <code>docker image ls</code>, you can see that
Docker has automatically used the <code>latest</code> tag for our new
container image.</p></li>
<li><p>We want to use <code>docker container run</code> to run a
container based on a container image.</p></li>
</ol>
<p>The following command should run a container and print out our
default message, the version of Python:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">$</span> docker container run alice/alpine-python</span></code></pre>
</div>
<p>To run a container based on our container image and print out “Hello
world” instead:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">$</span> docker container run alice/alpine-python echo <span class="st">"Hello World"</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>While it may not look like you have achieved much, you have already
effected the combination of a lightweight Linux operating system with
your specification to run a given command that can operate reliably on
macOS, Microsoft Windows, Linux and on the cloud!</p>
</section><section><h2 class="section-heading" id="boring-but-important-notes-about-installation">Boring but important notes about installation<a class="anchor" aria-label="anchor" href="#boring-but-important-notes-about-installation"></a>
</h2>
<hr class="half-width">
<p>There are a lot of choices when it comes to installing software –
sometimes too many! Here are some things to consider when creating your
own container image:</p>
<ul>
<li>
<strong>Start smart</strong>, or, don’t install everything from
scratch! If you’re using Python as your main tool, start with a <a href="https://hub.docker.com/_/python" class="external-link">Python container image</a>. Same
with R. We’ve used Alpine Linux as an example in this lesson, but it’s
generally not a good container image to start with for initial
development and experimentation because it is a less common distribution
of Linux; using <a href="https://hub.docker.com/_/ubuntu" class="external-link">Ubuntu</a>, <a href="https://hub.docker.com/_/debian" class="external-link">Debian</a> and <a href="https://hub.docker.com/_/centos" class="external-link">CentOS</a> are all good options
for scientific software installations. The program you’re using might
recommend a particular distribution of Linux, and if so, it may be
useful to start with a container image for that distribution.</li>
<li>
<strong>How big?</strong> How much software do you really need to
install? When you have a choice, lean towards using smaller starting
container images and installing only what’s needed for your software, as
a bigger container image means longer download times to use.</li>
<li>
<strong>Know (or Google) your Linux</strong>. Different
distributions of Linux often have distinct sets of tools for installing
software. The <code>apk</code> command we used above is the software
package installer for Alpine Linux. The installers for various common
Linux distributions are listed below:
<ul>
<li>Ubuntu: <code>apt</code> or <code>apt-get</code>
</li>
<li>Debian: <code>deb</code>
</li>
<li>CentOS: <code>yum</code> Most common software installations are
available to be installed via these tools. A web search for “install X
on Y Linux” is usually a good start for common software installation
tasks; if something isn’t available via the Linux distribution’s
installation tools, try the options below.</li>
</ul>
</li>
<li>
<strong>Use what you know</strong>. You’ve probably used commands
like <code>pip</code> or <code>install.packages()</code> before on your
own computer – these will also work to install things in container
images (if the basic scripting language is installed).</li>
<li>
<strong>README</strong>. Many scientific software tools have a
README or installation instructions that lay out how to install
software. You want to look for instructions for Linux. If the install
instructions include options like those suggested above, try those
first.</li>
</ul>
<p>In general, a good strategy for installing software is:</p>
<ul>
<li>Make a list of what you want to install.</li>
<li>Look for pre-existing container images.</li>
<li>Read through instructions for software you’ll need to install.</li>
<li>Try installing everything interactively in your base container –
take notes!</li>
<li>From your interactive installation, create a <code>Dockerfile</code>
and then try to build the container image from that.</li>
</ul></section><section><h2 class="section-heading" id="share-your-new-container-image-on-docker-hub">Share your new container image on Docker Hub<a class="anchor" aria-label="anchor" href="#share-your-new-container-image-on-docker-hub"></a>
</h2>
<hr class="half-width">
<p>Container images that you release publicly can be stored on the
Docker Hub for free. If you name your container image as described
above, with your Docker Hub username, all you need to do is run the
opposite of <code>docker image pull</code> –
<code>docker image push</code>.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="ex">$</span> docker image push alice/alpine-python</span></code></pre>
</div>
<p>Make sure to substitute the full name of your container image!</p>
<p>In a web browser, open <a href="https://hub.docker.com" class="external-link">https://hub.docker.com</a>, and on your
user page you should now see your container image listed, for anyone to
use or build on.</p>
<div id="logging-in" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="logging-in" class="callout-inner">
<h3 class="callout-title">Logging In</h3>
<div class="callout-content">
<p>Technically, you have to be logged into Docker on your computer for
this to work. Usually it happens by default, but if
<code>docker image push</code> doesn’t work for you, run
<code>docker login</code> first, enter your Docker Hub username and
password, and then try <code>docker image push</code> again.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="whats-in-a-name-again">What’s in a name? (again)<a class="anchor" aria-label="anchor" href="#whats-in-a-name-again"></a>
</h2>
<hr class="half-width">
<p>You don’t <em>have</em> to name your containers images using the
<code>USERNAME/CONTAINER_IMAGE_NAME:TAG</code> naming scheme. On your
own computer, you can call container images whatever you want, and refer
to them by the names you choose. It’s only when you want to share a
container image that it needs the correct naming format.</p>
<p>You can rename container images using the
<code>docker image tag</code> command. For example, imagine someone
named Alice has been working on a workflow container image and called it
<code>workflow-test</code> on her own computer. She now wants to share
it in her <code>alice</code> Docker Hub account with the name
<code>workflow-complete</code> and a tag of <code>v1</code>. Her
<code>docker image tag</code> command would look like this:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="ex">$</span> docker image tag workflow-test alice/workflow-complete:v1</span></code></pre>
</div>
<p>She could then push the re-named container image to Docker Hub, using
<code>docker image push alice/workflow-complete:v1</code></p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>
<code>Dockerfile</code>s specify what is within Docker container
images.</li>
<li>The <code>docker image build</code> command is used to build a
container image from a <code>Dockerfile</code>.</li>
<li>You can share your Docker container images through the Docker Hub so
that others can create Docker containers from your container
images.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-advanced-containers"><p>Content from <a href="advanced-containers.html">Creating More Complex Container Images</a></p>
<hr>
<p>Last updated on 2024-10-15 |

        <a href="https://github.com/UoMResearchIT/docker-introduction/edit/main/episodes/advanced-containers.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>In order to create and use your own container images, you may need
more information than our previous example. You may want to use files
from outside the container, that are not included within the container
image, either by copying the files into the container image, or by
making them visible within a running container from their existing
location on your host system. You may also want to learn a little bit
about how to install software within a running container or a container
image. This episode will look at these advanced aspects of running a
container or building a container image. Note that the examples will get
gradually more and more complex – most day-to-day use of containers and
container images can be accomplished using the first 1–2 sections on
this page.</p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I make more complex container images?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how you can include files within Docker container images
when you build them.</li>
<li>Explain how you can access files on the Docker host from your Docker
containers.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="using-scripts-and-files-from-outside-the-container">Using scripts and files from outside the container<a class="anchor" aria-label="anchor" href="#using-scripts-and-files-from-outside-the-container"></a>
</h2>
<hr class="half-width">
<p>In your shell, change to the <code>sum</code> folder in the
<code>docker-intro</code> folder and look at the files inside.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> cd ~/Desktop/docker-intro/sum</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">$</span> ls</span></code></pre>
</div>
<p>This folder has both a <code>Dockerfile</code> and a Python script
called <code>sum.py</code>. Let’s say we wanted to try running the
script using a container based on our recently created
<code>alpine-python</code> container image.</p>
<div id="running-containers" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="running-containers" class="callout-inner">
<h3 class="callout-title">Running containers</h3>
<div class="callout-content">
<p>What command would we use to run Python from the
<code>alpine-python</code> container?</p>
</div>
</div>
</div>
<p>If we try running the container and Python script, what happens?</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">$</span> docker container run alice/alpine-python python3 sum.py</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>python3: can't open file 'sum.py': [Errno 2] No such file or directory</code></pre>
</div>
<div id="no-such-file-or-directory" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="no-such-file-or-directory" class="callout-inner">
<h3 class="callout-title">No such file or directory</h3>
<div class="callout-content">
<p>What does the error message mean? Why might the Python inside the
container not be able to find or open our script?</p>
</div>
</div>
</div>
<p>The problem here is that the container and its filesystem is separate
from our host computer’s filesystem. When the container runs, it can’t
see anything outside itself, including any of the files on our computer.
In order to use Python (inside the container) and our script (outside
the container, on our host computer), we need to create a link between
the directory on our computer and the container.</p>
<p>This link is called a “mount” and is what happens automatically when
a USB drive or other external hard drive gets connected to a computer –
you can see the contents appear as if they were on your computer.</p>
<p>We can create a mount between our computer and the running container
by using an additional option to <code>docker container run</code>.
We’ll also use the variable <code>${PWD}</code> which will substitute in
our current working directory. The option will look like this</p>
<p><code>--mount type=bind,source=${PWD},target=/temp</code></p>
<p>What this means is: make my current working directory (on the host
computer) – the source – <em>visible</em> within the container that is
about to be started, and inside this container, name the directory
<code>/temp</code> – the target.</p>
<div id="types-of-mounts" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="types-of-mounts" class="callout-inner">
<h3 class="callout-title">Types of mounts</h3>
<div class="callout-content">
<p>You will notice that we set the mount <code>type=bind</code>, there
are other types of mount that can be used in Docker
(e.g. <code>volume</code> and <code>tmpfs</code>). We do not cover other
types of mounts or the differences between these mount types in the
course as it is more of an advanced topic. You can find more information
on the different mount types in <a href="https://docs.docker.com/storage/" class="external-link">the Docker
documentation</a>.</p>
</div>
</div>
</div>
<p>Let’s try running the command now:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">$</span> docker container run <span class="at">--mount</span> type=bind,source=<span class="va">${PWD}</span>,target=/temp alice/alpine-python python3 sum.py</span></code></pre>
</div>
<p>But we get the same error!</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>python3: can't open file 'sum.py': [Errno 2] No such file or directory</code></pre>
</div>
<p>This final piece is a bit tricky – we really have to remember to put
ourselves inside the container. Where is the <code>sum.py</code> file?
It’s in the directory that’s been mapped to <code>/temp</code> – so we
need to include that in the path to the script. This command should give
us what we need:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">$</span> docker container run <span class="at">--mount</span> type=bind,source=<span class="va">${PWD}</span>,target=/temp alice/alpine-python python3 /temp/sum.py</span></code></pre>
</div>
<p>Note that if we create any files in the <code>/temp</code> directory
while the container is running, these files will appear on our host
filesystem in the original directory and will stay there even when the
container stops.</p>
<div id="other-commonly-used-docker-run-flags" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="other-commonly-used-docker-run-flags" class="callout-inner">
<h3 class="callout-title">Other Commonly Used Docker Run Flags</h3>
<div class="callout-content">
<p>Docker run has many other useful flags to alter its function. A
couple that are commonly used include <code>-w</code> and
<code>-u</code>.</p>
<p>The <code>--workdir</code>/<code>-w</code> flag sets the working
directory a.k.a. runs the command being executed inside the directory
specified. For example, the following code would run the
<code>pwd</code> command in a container started from the latest ubuntu
image in the <code>/home/alice</code> directory and print
<code>/home/alice</code>. If the directory doesn’t exist in the image it
will create it.</p>
<pre><code>docker container run -w /home/alice/ ubuntu pwd</code></pre>
<p>The <code>--user</code>/<code>-u</code> flag lets you specify the
username you would like to run the container as. This is helpful if
you’d like to write files to a mounted folder and not write them as
<code>root</code> but rather your own user identity and group. A common
example of the <code>-u</code> flag is
<code>--user $(id -u):$(id -g)</code> which will fetch the current
user’s ID and group and run the container as that user.</p>
</div>
</div>
</div>
<div id="exercise-explore-the-script" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-explore-the-script" class="callout-inner">
<h3 class="callout-title">Exercise: Explore the script</h3>
<div class="callout-content">
<p>What happens if you use the <code>docker container run</code> command
above and put numbers after the script name?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>This script comes from <a href="https://wiki.python.org/moin/SimplePrograms" class="external-link">the Python Wiki</a>
and is set to add all numbers that are passed to it as arguments.</p>
</div>
</div>
</div>
</div>
<div id="exercise-checking-the-options" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-checking-the-options" class="callout-inner">
<h3 class="callout-title">Exercise: Checking the options</h3>
<div class="callout-content">
<p>Our Docker command has gotten much longer! Can you go through each
piece of the Docker command above and explain what it does? How would
you characterize the key components of a Docker command?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Here’s a breakdown of each piece of the command above</p>
<ul>
<li>
<code>docker container run</code>: use Docker to run a
container</li>
<li>
<code>--mount type=bind,source=${PWD},target=/temp</code>: connect
my current working directory (<code>${PWD}</code>) as a folder inside
the container called <code>/temp</code>
</li>
<li>
<code>alice/alpine-python</code>: name of the container image to use
to run the container</li>
<li>
<code>python3 /temp/sum.py</code>: what commands to run in the
container</li>
</ul>
<p>More generally, every Docker command will have the form:
<code>docker [action] [docker options] [docker container image] [command to run inside]</code></p>
</div>
</div>
</div>
</div>
<div id="exercise-interactive-jobs" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-interactive-jobs" class="callout-inner">
<h3 class="callout-title">Exercise: Interactive jobs</h3>
<div class="callout-content">
<p>Try using the directory mount option but run the container
interactively. Can you find the folder that’s connected to your host
computer? What’s inside?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>The docker command to run the container interactively is:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">$</span> docker container run <span class="at">--mount</span> type=bind,source=<span class="va">${PWD}</span>,target=/temp <span class="at">-it</span> alice/alpine-python sh</span></code></pre>
</div>
<p>Once inside, you should be able to navigate to the <code>/temp</code>
folder and see that’s contents are the same as the files on your host
computer:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">/#</span> cd /temp</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="ex">/#</span> ls</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Mounting a directory can be very useful when you want to run the
software inside your container on many different input files. In other
situations, you may want to save or archive an authoritative version of
your data by adding it to the container image permanently. That’s what
we will cover next.</p>
</section><section><h2 class="section-heading" id="including-your-scripts-and-data-within-a-container-image">Including your scripts and data within a container image<a class="anchor" aria-label="anchor" href="#including-your-scripts-and-data-within-a-container-image"></a>
</h2>
<hr class="half-width">
<p>Our next project will be to add our own files to a container image –
something you might want to do if you’re sharing a finished analysis or
just want to have an archived copy of your entire analysis including the
data. Let’s assume that we’ve finished with our <code>sum.py</code>
script and want to add it to the container image itself.</p>
<p>In your shell, you should still be in the <code>sum</code> folder in
the <code>docker-intro</code> folder.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">$</span> pwd</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">$</span> /Users/yourname/Desktop/docker-intro/sum</span></code></pre>
</div>
<p>Let’s add a new line to the <code>Dockerfile</code> we’ve been using
so far to create a copy of <code>sum.py</code>. We can do so by using
the <code>COPY</code> keyword.</p>
<pre><code>COPY sum.py /home</code></pre>
<p>This line will cause Docker to copy the file from your computer into
the container’s filesystem. Let’s build the container image like before,
but give it a different name:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">$</span> docker image build <span class="at">-t</span> alice/alpine-sum .</span></code></pre>
</div>
<div id="the-importance-of-command-order-in-a-dockerfile" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="the-importance-of-command-order-in-a-dockerfile" class="callout-inner">
<h3 class="callout-title">The Importance of Command Order in a Dockerfile</h3>
<div class="callout-content">
<p>When you run <code>docker build</code> it executes the build in the
order specified in the <code>Dockerfile</code>. This order is important
for rebuilding and you typically will want to put your <code>RUN</code>
commands before your <code>COPY</code> commands.</p>
<p>Docker builds the layers of commands in order. This becomes important
when you need to rebuild container images. If you change layers later in
the <code>Dockerfile</code> and rebuild the container image, Docker
doesn’t need to rebuild the earlier layers but will instead used a
stored (called “cached”) version of those layers.</p>
<p>For example, in an instance where you wanted to copy
<code>multiply.py</code> into the container image instead of
<code>sum.py</code>. If the <code>COPY</code> line came before the
<code>RUN</code> line, it would need to rebuild the whole image. If the
<code>COPY</code> line came second then it would use the cached
<code>RUN</code> layer from the previous build and then only rebuild the
<code>COPY</code> layer.</p>
</div>
</div>
</div>
<div id="exercise-did-it-work" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-did-it-work" class="callout-inner">
<h3 class="callout-title">Exercise: Did it work?</h3>
<div class="callout-content">
<p>Can you remember how to run a container interactively? Try that with
this one. Once inside, try running the Python script.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>You can start the container interactively like so:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">$</span> docker container run <span class="at">-it</span> alice/alpine-sum sh</span></code></pre>
</div>
<p>You should be able to run the python command inside the container
like this:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">/#</span> python3 /home/sum.py</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>This <code>COPY</code> keyword can be used to place your own scripts
or own data into a container image that you want to publish or use as a
record. Note that it’s not necessarily a good idea to put your scripts
inside the container image if you’re constantly changing or editing
them. Then, referencing the scripts from outside the container is a good
idea, as we did in the previous section. You also want to think
carefully about size – if you run <code>docker image ls</code> you’ll
see the size of each container image all the way on the right of the
screen. The bigger your container image becomes, the harder it will be
to easily download.</p>
<div id="callout4" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>## Security warning Login credentials including passwords, tokens,
secure access tokens or other secrets must never be stored in a
container. If secrets are stored, they are at high risk to be found and
exploited when made public.</p>
</div>
</div>
</div>
<div id="copying-alternatives" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="copying-alternatives" class="callout-inner">
<h3 class="callout-title">Copying alternatives</h3>
<div class="callout-content">
<p>Another trick for getting your own files into a container image is by
using the <code>RUN</code> keyword and downloading the files from the
internet. For example, if your code is in a GitHub repository, you could
include this statement in your Dockerfile to download the latest version
every time you build the container image:</p>
<pre><code>RUN git clone https://github.com/alice/mycode</code></pre>
<p>Similarly, the <code>wget</code> command can be used to download any
file publicly available on the internet:</p>
<pre><code>RUN wget ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/2.10.0/ncbi-blast-2.10.0+-x64-linux.tar.gz</code></pre>
<p>Note that the above <code>RUN</code> examples depend on commands
(<code>git</code> and <code>wget</code> respectively) that must be
available within your container: Linux distributions such as Alpine may
require you to install such commands before using them within
<code>RUN</code> statements.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="more-fancy-dockerfile-options-optional-for-presentation-or-as-exercises">More fancy <code>Dockerfile</code> options (optional, for
presentation or as exercises)<a class="anchor" aria-label="anchor" href="#more-fancy-dockerfile-options-optional-for-presentation-or-as-exercises"></a>
</h2>
<hr class="half-width">
<p>We can expand on the example above to make our container image even
more “automatic”. Here are some ideas:</p>
<div class="section level3">
<h3 id="make-the-sum-py-script-run-automatically">Make the <code>sum.py</code> script run automatically<a class="anchor" aria-label="anchor" href="#make-the-sum-py-script-run-automatically"></a>
</h3>
<pre><code>FROM alpine
RUN apk add --update python3 py3-pip python3-dev
COPY sum.py /home

# Run the sum.py script as the default command
CMD ["python3", "/home/sum.py"]</code></pre>
<p>Build and test it:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="ex">$</span> docker image build <span class="at">-t</span> alpine-sum:v1 .</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="ex">$</span> docker container run alpine-sum:v1</span></code></pre>
</div>
<p>You’ll notice that you can run the container without arguments just
fine, resulting in <code>sum = 0</code>, but this is boring. Supplying
arguments however doesn’t work:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="ex">docker</span> container run alpine-sum:v1 10 11 12</span></code></pre>
</div>
<p>results in</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>docker: Error response from daemon: OCI runtime create failed:
container_linux.go:349: starting container process caused "exec:
\"10\": executable file not found in $PATH": unknown.</code></pre>
</div>
<p>This is because the arguments <code>10 11 12</code> are interpreted
as a <em>command</em> that replaces the default command given by
<code>CMD ["python3", "/home/sum.py"]</code> in the image.</p>
<p>To achieve the goal of having a command that <em>always</em> runs
when a container is run from the container image <em>and</em> can be
passed the arguments given on the command line, use the keyword
<code>ENTRYPOINT</code> in the <code>Dockerfile</code>.</p>
<pre><code>FROM alpine

COPY sum.py /home
RUN apk add --update python3 py3-pip python3-dev

# Run the sum.py script as the default command and
# allow people to enter arguments for it
ENTRYPOINT ["python3", "/home/sum.py"]

# Give default arguments, in case none are supplied on
# the command-line
CMD ["10", "11"]</code></pre>
<p>Build and test it:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="ex">$</span> docker image build <span class="at">-t</span> alpine-sum:v2 .</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="co"># Most of the time you are interested in the sum of 10 and 11:</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="ex">$</span> docker container run alpine-sum:v2</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="co"># Sometimes you have more challenging calculations to do:</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="ex">$</span> docker container run alpine-sum:v2 12 13 14</span></code></pre>
</div>
<div id="overriding-the-entrypoint" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="overriding-the-entrypoint" class="callout-inner">
<h3 class="callout-title">Overriding the ENTRYPOINT</h3>
<div class="callout-content">
<p>Sometimes you don’t want to run the image’s <code>ENTRYPOINT</code>.
For example if you have a specialized container image that does only
sums, but you need an interactive shell to examine the container:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="ex">$</span> docker container run <span class="at">-it</span> alpine-sum:v2 /bin/sh</span></code></pre>
</div>
<p>will yield</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Please supply integer arguments</code></pre>
</div>
<p>You need to override the <code>ENTRYPOINT</code> statement in the
container image like so:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="ex">$</span> docker container run <span class="at">-it</span> <span class="at">--entrypoint</span> /bin/sh alpine-sum:v2</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="add-the-sum-py-script-to-the-path-so-you-can-run-it-directly">Add the <code>sum.py</code> script to the <code>PATH</code> so you
can run it directly:<a class="anchor" aria-label="anchor" href="#add-the-sum-py-script-to-the-path-so-you-can-run-it-directly"></a>
</h3>
<pre><code>FROM alpine

RUN apk add --update python3 py3-pip python3-dev

COPY sum.py /home
# set script permissions
RUN chmod +x /home/sum.py
# add /home folder to the PATH
ENV PATH /home:$PATH</code></pre>
<p>Build and test it:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="ex">$</span> docker image build <span class="at">-t</span> alpine-sum:v3 .</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="ex">$</span> docker container run alpine-sum:v3 sum.py 1 2 3 4</span></code></pre>
</div>
<div id="best-practices-for-writing-dockerfiles" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="best-practices-for-writing-dockerfiles" class="callout-inner">
<h3 class="callout-title">Best practices for writing Dockerfiles</h3>
<div class="callout-content">
<p>Take a look at Nüst et al.’s “<a href="https://doi.org/10.1371/journal.pcbi.1008316" class="external-link"><em>Ten simple rules
for writing Dockerfiles for reproducible data science</em></a>” [1] for
some great examples of best practices to use when writing Dockerfiles.
The <a href="https://github.com/nuest/ten-simple-rules-dockerfiles" class="external-link">GitHub
repository</a> associated with the paper also has a set of <a href="https://github.com/nuest/ten-simple-rules-dockerfiles/tree/master/examples" class="external-link">example
<code>Dockerfile</code>s</a> demonstrating how the rules highlighted by
the paper can be applied.</p>
<p><small>[1] Nüst D, Sochat V, Marwick B, Eglen SJ, Head T, et
al. (2020) Ten simple rules for writing Dockerfiles for reproducible
data science. PLOS Computational Biology 16(11): e1008316. <a href="https://doi.org/10.1371/journal.pcbi.1008316" class="external-link">https://doi.org/10.1371/journal.pcbi.1008316</a></small></p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Docker allows containers to read and write files from the Docker
host.</li>
<li>You can include files from your Docker host into your Docker
container images by using the <code>COPY</code> instruction in your
<code>Dockerfile</code>.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/UoMResearchIT/docker-introduction/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/UoMResearchIT/docker-introduction/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/UoMResearchIT/docker-introduction/" class="external-link">Source</a></p>
				<p><a href="https://github.com/UoMResearchIT/docker-introduction/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.8" class="external-link">sandpaper (0.16.8)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.6" class="external-link">pegboard (0.7.6)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.4" class="external-link">varnish (1.0.4)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://uomresearchit.github.io/docker-introduction/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://uomresearchit.github.io/docker-introduction/aio.html",
  "identifier": "https://uomresearchit.github.io/docker-introduction/aio.html",
  "dateCreated": "2015-04-18",
  "dateModified": "2024-10-15",
  "datePublished": "2024-10-15"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo --><script>
          var _paq = window._paq = window._paq || [];
          /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
          _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
          _paq.push(["setDomains", ["*.lessons.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
          _paq.push(["setDoNotTrack", true]);
          _paq.push(["disableCookies"]);
          _paq.push(["trackPageView"]);
          _paq.push(["enableLinkTracking"]);
          (function() {
              var u="https://matomo.carpentries.org/";
              _paq.push(["setTrackerUrl", u+"matomo.php"]);
              _paq.push(["setSiteId", "1"]);
              var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0];
              g.async=true; g.src="https://matomo.carpentries.org/matomo.js"; s.parentNode.insertBefore(g,s);
          })();
        </script><!-- End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

